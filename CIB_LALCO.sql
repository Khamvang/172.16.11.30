-- 1) Create database and table

create database cib_report character set utf8mb4 collate utf8mb4_general_ci;


create table `cib_report.tbla1` (
	`id` int(11) not null auto_increment ,
	`date_report` date not null ,
	`contract_no` int(11) not null ,
	`bank_customer_ID` varchar(255) default null,
	`branch_ID_code` varchar(255) default null,
	`group_ID` varchar(255) default null,
	`head_of_group` varchar(255) default null,
	`national_ID` varchar(255) default null,
	`national_ID_expiry_date` varchar(255) default null,
	`passport_number` varchar(255) default null,
	`passport_expiry_date` varchar(255) default null,
	`familybook` varchar(255) default null,
	`family_province_code_if_issue` varchar(255) default null,
	`family_issue_date` varchar(255) default null,
	`birthdate` varchar(255) default null,
	`1st_name_(english)` varchar(255) default null,
	`2nd_name_(english)` varchar(255) default null,
	`surname_(english)` varchar(255) default null,
	`1st_name_(lao)` varchar(255) default null,
	`surname_(lao)` varchar(255) default null,
	`old _surname_(english)` varchar(255) default null,
	`old_surname_(lao)` varchar(255) default null,
	`nationality` varchar(255) default null,
	`gender` varchar(255) default null,
	`civil_status` varchar(255) default null,
	`spouse_1st_(english)` varchar(255) default null,
	`spouse_2nd_(english)` varchar(255) default null,
	`spouse_surname_(english)` varchar(255) default null,
	`spouse_1st_(lao)` varchar(255) default null,
	`spouse_surname_(lao)` varchar(255) default null,
	`datetime_updated` varchar(255) default null,
	primary key (`id`)
)ENGINE=InnoDB auto_increment=1 default CHARSET = utf8mb4 collate utf8mb4_general_ci;


create table `cib_report.tbla4` (
	`id` int(11) not null auto_increment ,
	`date_report` date not null ,
	`contract_no` int(11) not null ,
	`bank_customer_ID` varchar(255) not null,
	`branch_ID_code` varchar(255) default null,
	`address_number_and_street_(english)` varchar(255) default null,
	`address_village_(english)` varchar(255) default null,
	`address_district_(english)` varchar(255) default null,
	`address_number_and_street_(lao)` varchar(255) default null,
	`address_village_(lao)` varchar(255) default null,
	`address_district_(lao)` varchar(255) default null,
	`address_province_code` varchar(255) default null,
	`datetime_updated` varchar(255) default null,
	primary key (`id`)
)ENGINE=InnoDB auto_increment=1 default CHARSET = utf8mb4 collate utf8mb4_general_ci;


create table `tbla5` (
	`id` int(11) not null auto_increment ,
	`date_report` date not null ,
	`contract_no` int(11) not null ,
	`bank_customer_ID` varchar(255) not null,
	`branch_ID_code` varchar(255) default null,
	`telephone_no` varchar(255) default null,
	`mobile_no` varchar(255) default null,
	`fax` varchar(255) default null,
	`datetime_updated` varchar(255) default null,
	primary key (`id`)
)ENGINE=InnoDB auto_increment=1 default CHARSET = utf8mb4 collate utf8mb4_general_ci;


create table `cib_report.tblb1` (
	`id` int(11) not null auto_increment ,
	`date_report` date not null ,
	`contract_no` int(11) not null ,
	`bank_customer_ID` varchar(255) not null,
	`branch_ID_code` varchar(255) not null,
	`loan_ID` varchar(255) not null,
	`open_date` varchar(255) not null,
	`expiry_date` varchar(255) default null,
	`extension_date` varchar(255) default null,
	`interest_rate` decimal(20,2) not null,
	`purpose_code` varchar(255) not null,
	`amount_of_loan` decimal(20,2) not null,
	`currency_code` varchar(255) not null,
	`outstanding_balance` decimal(20,2) not null,
	`loan_account_number` varchar(255) default null,
	`number_of_days_slow` int(11) not null,
	`loan_class` varchar(255) not null,
	`loan_type` varchar(255) not null,
	`loan_term` varchar(255) not null,
	`loan_status` varchar(255) not null,
	`date_time_updated` varchar(255) not null,
	primary key (`id`)
)ENGINE=InnoDB auto_increment=1 default CHARSET = utf8mb4 collate utf8mb4_general_ci;


create table `cib_report.tblc1` (
	`id` int(11) not null auto_increment ,
	`date_report` date not null ,
	`contract_no` int(11) not null ,
	`bank_customer_ID` varchar(255) default null,
	`branch_ID_code` varchar(255) default null,
	`loan_ID` varchar(255) default null,
	`collateral_ID` varchar(255) default null,
	`owner_gender` varchar(255) default null,
	`owner_1st_name_(english)` varchar(255) default null,
	`owner 2nd_name_(english)` varchar(255) default null,
	`owner_surname_(english)` varchar(255) default null,
	`owner_1st_name_(lao)` varchar(255) default null,
	`owner_surname_(lao)` varchar(255) default null,
	`collateral_type` varchar(255) default null,
	`collateral_value`  decimal(20,2) not null,
	`currency_code` varchar(255) default null,
	`collateral_status` varchar(255) default null,
	`date_time_updated` varchar(255) default null,
	primary key (`id`)
)ENGINE=InnoDB auto_increment=1 default CHARSET = utf8mb4 collate utf8mb4_general_ci;


create table cib_report.`tblc2.5` (
	`id` int(11) not null auto_increment ,
	`date_report` date not null ,
	`contract_no` int(11) not null ,
	`bank_customer_ID` varchar(255) default null,
	`branch_ID_code` varchar(255) default null,
	`loan_ID` varchar(255) default null,
	`collateral_ID` varchar(255) default null,
	`plate_number` varchar(255) default null,
	`engine_number` varchar(255) default null,
	`body_number` varchar(255) default null,
	`model` varchar(255) default null,
	`value` decimal(20,2) not null,
	primary key (`id`)
)ENGINE=InnoDB auto_increment=1 default CHARSET = utf8mb4 collate utf8mb4_general_ci;


-- 2) Export data from LALCO
# check and export the contract numbers
select c.contract_no , from_unixtime(c.disbursed_datetime, '%Y-%m-%d') 'disbursed_date' 
from tblcontract c left join tblprospect p on (p.id = c.prospect_id)
where p.contract_type in (1,2,3,4) and c.status in (4,6,7) and from_unixtime(c.disbursed_datetime, '%Y-%m-%d') between '2024-02-01' and '2025-02-28'; 


#CIB A1 as table

-- insert A1 the old data from last month report 
insert into cib_report.tbla1 (`date_report`,`contract_no`,`bank_customer_ID`,`branch_ID_code`,`group_ID`,`head_of_group`,`national_ID`,`national_ID_expiry_date`,`passport_number`,`passport_expiry_date`,`familybook`,`family_province_code_if_issue`,`family_issue_date`,`birthdate`,`1st_name_(english)`,`2nd_name_(english)`,`surname_(english)`,`1st_name_(lao)`,`surname_(lao)`,`old _surname_(english)`,`old_surname_(lao)`,`nationality`,`gender`,`civil_status`,`spouse_1st_(english)`,`spouse_2nd_(english)`,`spouse_surname_(english)`,`spouse_1st_(lao)`,`spouse_surname_(lao)`,`datetime_updated`)
select '2025-02-28',`contract_no`,`bank_customer_ID`,`branch_ID_code`,`group_ID`,`head_of_group`,`national_ID`,`national_ID_expiry_date`,`passport_number`,`passport_expiry_date`,`familybook`,`family_province_code_if_issue`,`family_issue_date`,`birthdate`,`1st_name_(english)`,`2nd_name_(english)`,`surname_(english)`,`1st_name_(lao)`,`surname_(lao)`,`old _surname_(english)`,`old_surname_(lao)`,`nationality`,`gender`,`civil_status`,`spouse_1st_(english)`,`spouse_2nd_(english)`,`spouse_surname_(english)`,`spouse_1st_(lao)`,`spouse_surname_(lao)`,`datetime_updated`
from cib_report.tbla1 
where date_report = '2025-01-31'
	AND contract_no NOT IN (SELECT contract_no FROM cib_report.tbla1 WHERE date_report = '2025-02-28' )

-- insert A1 new data from LALCO live server
SELECT DISTINCT 
	-- dr.`date` `date_report`,
	'2025-02-28'  `date_report`,
	c.contract_no ,
	case when length(c.ncn)>=6 then c.ncn when length(c.ncn)=5 then concat('0',c.ncn) when length(c.ncn)=4 then concat('00',c.ncn) else c.ncn end `bank_customer_ID`,
	CASE p.call_centre WHEN 1 THEN '01' ELSE '01' END `branch_ID_code`,
	'' `group_ID`,
	'' `head_of_group`,
	'' `national_ID`,
	'' `national_ID_expiry_date`,
	'' `passport_number`,
	'' `passport_expiry_date`,
	CASE WHEN cu.identifier_id = '' THEN 000 
		ELSE convert(cast(convert(cu.identifier_id using latin1) as binary) using utf8)
	END `familybook`,
	CASE
		cu.address_province WHEN 1 THEN 'ATP' -- ATTAPEU
		WHEN 2 THEN 'BK' -- BORKEO
		WHEN 3 THEN 'BKX' -- BORLIKHAMXAY
		WHEN 4 THEN 'CPS' -- CHAMPASACK
		WHEN 5 THEN 'HP' -- HOUAPHAN
		WHEN 6 THEN 'KM' -- KHAMMOUANE
		WHEN 7 THEN 'LNT' -- LUANGNAMTHA
		WHEN 8 THEN 'LPB' -- LUANGPRABANG
		WHEN 9 THEN 'ODX' -- OUDOMXAY
		WHEN 10 THEN 'PSL' -- PHONGSALY
		WHEN 11 THEN 'SLV' -- SALAVAN
		WHEN 12 THEN 'SV' -- SAVANNAKHET
		WHEN 13 THEN 'NKL' -- VIENTIANE CAPITAL
		WHEN 14 THEN 'VT' -- VIENTIANE PROVINCE
		WHEN 15 THEN 'XYL' -- XAYABOULY
		WHEN 16 THEN 'XSB' -- XAYSOMBOUN
		WHEN 17 THEN 'SK' -- SEKONG
		WHEN 18 THEN 'XKH' -- XIENGKHUANG
		ELSE ''
	END `family_province_code_if_issue`,
	CASE WHEN DATE_FORMAT(cu.family_book_issue_date,'%d/%m/%Y') = '00/00/0000' THEN '01/01/1970' 
		ELSE DATE_FORMAT(cu.family_book_issue_date,'%d/%m/%Y')
	END `family_issue_date`,
	DATE_FORMAT(cu.date_of_birth, '%d/%m/%Y') `birthdate`,
	CONVERT(CAST(CONVERT(CONCAT(cu.customer_first_name_en) using latin1) as binary) using utf8) `1st_name_(english)`,
	'' `2nd_name_(english)`,
	CONVERT(CAST(CONVERT(CONCAT(cu.customer_last_name_en ) using latin1) as binary) using utf8) `surname_(english)`,
	CONVERT(CAST(CONVERT(CONCAT(cu.customer_first_name_lo) using latin1) as binary) using utf8) `1st_name_(lao)`,
	CONVERT(CAST(CONVERT(CONCAT(cu.customer_last_name_lo) using latin1) as binary) using utf8) `surname_(lao)`,
	'' `old _surname_(english)`,
	'' `old_surname_(lao)`,
	CASE p.call_centre WHEN 1 THEN 'LA' ELSE 'LA' END 'nationality',
	CASE  WHEN cu.gender = 'Male' THEN 'M' WHEN cu.gender = 'Female' THEN 'F' ELSE '' END `gender`,
	CASE  WHEN cu.marital_status = 'Married' THEN 'M' WHEN cu.marital_status = 'Single' THEN 'S' ELSE '' END `civil_status`,
	'' `spouse_1st_(english)`,
	'' `spouse_2nd_(english)`,
	'' `spouse_surname_(english)`,
	'' `spouse_1st_(lao)`,
	'' `spouse_surname_(lao)`,
	FROM_UNIXTIME(c.date_updated , '%d/%m/%Y %H:%m:%S') `datetime_updated`
FROM  tblcustomer cu
RIGHT JOIN tblprospect p ON (p.customer_id = cu.id)
RIGHT JOIN tblcontract c ON (c.prospect_id = p.id)
-- LEFT JOIN tbldailyreport dr ON  (dr.contract_id = c.id)
WHERE  p.status = 3 AND c.status in (4,6,7) -- AND dr.`date` = '2025-02-28' 
	and c.contract_no in (2103223,2115595,2114379,2115668,2115700,2115732,2115687,2115725,2115652,2115688,2115748,2115750,2115752,2115754,2115753,2115678,2115704,2115694,2115721,2115740,2115658,2115662,2115724,2115713,2115717,2115738,2115741,2115743,2115744,2115745,2115746,2115739,2115747,2115680,2115690,2115695,2115698,2115699,2115707,2115709,2115711,2115720,2115823,2115653,2115667,2115884,2115628,2115871,2115903,2115948,2115900,2115956,2115868,2115967,2115921,2115957,2115554,2115618,2115836,2115961,2115772,2115627,2115919,2115890,2115911,2115824,2115944,2115934,2115926,2115873,2115908,2115947,2115991,2115839,2115563,2115895,2115997,2115878,2115998,2115949,2115157,2115892,2115989,2116006,2116008,2115981,2115942,2115969,2115988,2116004,2115201,2115984,2111026,2115928,2115923,2116031,2115929,2116024,2116005,2115999,2115965,2116014,2115913,2115976,2116018,2116037,2114142,2115980,2116021,2116038,2115978,2116033,2115916,2115951,2116026,2115539,2116020,2116009,2116011,2115534,2115958,2115987,2116022,2116019,2116015,2116036,2116042,2115938,2116068,2116075,2109360,2115912,2115585,2116051,2116029,2116032,2116034,2115971,2115347,2115932,2116060,2116013,2116059,2115968,2116076,2116041,2116083,2116096,2116066,2116055,2116072,2114663,2116100,2116101,2116078,2116057,2116074,2116098,2116086,2116070,2116115,2116012,2113930,2116027,2116063,2116069,2115925,2116130,2116048,2115802,2116112,2115561,2116137,2116081,2116105,2116044,2115351,2116049,2116103,2115905,2116102,2116007,2115993,2116106,2115887,2116153,2116168,2115990,2116156,2115897,2116147,2116061,2116161,2116163,2116088,2116043,2116082,2116146,2116128,2116124,2116095,2116148,2116132,2116140,2116173,2116170,2115371,2115872,2116152,2116142,2116129,2116171,2116125,2116169,2116139,2116145,2116150,2114498,2109896,2115190,2114219,2116155,2116158,2116191,2113819,2116203,2116206,2116178,2116186,2115441,2116119,2116196,2116215,2116160,2116234,2116184,2116093,2116131,2116183,2116085,2115438,2116209,2116141,2116224,2116232,2116238,2116231,2116222,2116211,2116194,2116223,2116240,2115805,2116242,2116228,2116179,2116241,2115964,2116111,2116274,2116197,2116285,2116250,2116218,2116181,2116201,2116226,2114522,2116214,2115960,2116023,2116247,2116277,2116225,2116135,2116282,2116252,2116229,2116172,2115808,2116205,2116261,2116265,2116028,2116219,2116243,2112963,2116175,2116180,2116244,2115187,2116263,2116256,2116259,2116293,2116297,2116079,2116267,2116239,2116287,2116262,2116318,2116272,2113761,2116319,2116273,2116326,2116336,2116246,2116337,2116463,2116306,2116286,2116313,2116321,2116230,2116300,2116325,2116270,2115917,2116199,2116307,2116494,2116385,2116404,2116413,2116419,2116414,2116415,2116481,2116483,2116539,2116540,2116541,2116542,2116237,2116561,2116207,2116557,2116299,2116271,2116496,2116576,2116304,2116448,2116331,2116567,2116258,2116563,2116582,2116578,2116368,2116056,2116317,2116583,2116593,2116311,2116560,2116345,2116278,2116565,2116387,2116338,2116312,2116400,2116315,2116612,2116605,2116597,2116568,2116580,2116118,2116296,2116601,2116590,2116614,2116303,2116269,2116585,2116616,2116571,2116617,2116591,2116294,2116606,2116628,2116645,2116626,2116620,2116647,2113465,2116523,2116524,2116635,2116632,2116526,2116636,2116530,2116531,2116656,2116493,2116600,2116570,2116631,2116638,2116577,2116327,2116648,2116637,2116138,2116675,2116669,2116622,2116642,2116664,2116190,2116650,2116251,2116697,2115838,2116347,2116677,2116654,2115415,2116700,2116447,2116680,2116679,2116670,2116710,2116689,2116692,2116709,2116658,2116663,2112856,2116726,2116733,2116659,2116359,2116386,2116433,2116236,2116736,2116640,2116484,2116695,2116681,2116340,2116349,2116515,2116350,2116512,2116352,2116510,2116406,2116501,2116420,2116478,2116421,2116425,2116427,2116429,2116432,2116718,2116428,2116426,2116487,2116403,2116473,2116444,2116470,2116469,2116450,2116373,2116468,2116739,2116721,2116492,2116423,2116745,2116701,2116348,2115952,2116482,2116767,2116485,2116502,2116714,2116475,2114794,2116763,2116416,2116550,2116551,2116552,2116528,2116464,2116766,2116465,2116467,2116472,2116516,2116431,2116518,2116517,2116371,2116375,2116208,2116372,2116586,2116775,2116750,2116769,2116716,2116796,2116755,2116686,2116777,2116727,2116154,2116374,2116725,2116440,2116699,2116765,2116772,2116824,2116553,2116790,2116801,2116757,2116356,2116392,2116511,2116731,2116784,2116507,2116509,2116779,2116760,2116787,2116803,2116715,2116840,2116741,2116792,2116819,2116831,2116761,2116737,2116751,2116820,2116813,2116816,2116797,2116773,2116549,2116344,2116828,2116394,2116395,2116639,2116860,2116543,2116811,2116836,2116788,2116661,2116807,2116547,2116162,2116764,2116833,2116743,2116795,2116525,2116800,2116471,2116844,2116603,2116845,2116812,2116866,2114800,2116873,2116830,2116878
)
ORDER BY c.contract_no ;



#CIB A4 as table 

-- insert A4 the old data from last month report 
insert into cib_report.tbla4 (`date_report`,`contract_no`,`bank_customer_ID`,`branch_ID_code`,`address_number_and_street_(english)`,`address_village_(english)`,`address_district_(english)`,`address_number_and_street_(lao)`,`address_village_(lao)`,`address_district_(lao)`,`address_province_code`,`datetime_updated`)
select '2025-02-28',`contract_no`,`bank_customer_ID`,`branch_ID_code`,`address_number_and_street_(english)`,`address_village_(english)`,`address_district_(english)`,`address_number_and_street_(lao)`,`address_village_(lao)`,`address_district_(lao)`,`address_province_code`,`datetime_updated`
from cib_report.tbla4 where date_report = '2025-01-31';

-- insert A4 the old data from LALCO live server
SELECT DISTINCT 
	-- dr.`date` `date_report`,
	'2025-02-28' `date_report`,
	c.contract_no ,
	case when length(c.ncn)>=6 then c.ncn when length(c.ncn)=5 then concat('0',c.ncn) when length(c.ncn)=4 then concat('00',c.ncn) else c.ncn end `bank_customer_ID`,
	CASE p.call_centre WHEN 1 THEN '01' ELSE '01' END `branch_ID_code`,
	CASE WHEN cu.address_village_id != 0 THEN CONVERT(CAST(CONVERT(v.village_name using latin1) as binary) using utf8)
		ELSE CONVERT(CAST(CONVERT(cu.address_village using latin1) as binary) using utf8) 
	END `address_number_and_street_(english)`,
	CASE WHEN cu.address_village_id != 0 THEN CONVERT(CAST(CONVERT(v.village_name using latin1) as binary) using utf8)
		ELSE CONVERT(CAST(CONVERT(cu.address_village using latin1) as binary) using utf8) 
	END `address_village_(english)`,
	ci.city_name  `address_district_(english)`,
	CASE WHEN cu.address_village_id != 0 THEN CONVERT(CAST(CONVERT(v.village_name_lao using latin1) as binary) using utf8)
		ELSE CONVERT(CAST(CONVERT(cu.address_village using latin1) as binary) using utf8) 
	END `address_number_and_street_(lao)`,
	CASE WHEN cu.address_village_id != 0 THEN CONVERT(CAST(CONVERT(v.village_name_lao using latin1) as binary) using utf8)
		ELSE CONVERT(CAST(CONVERT(cu.address_village using latin1) as binary) using utf8) 
	END `address_village_(lao)`,
	convert(cast(convert(ci.city_name_lao using latin1) as binary) using utf8) `address_district_(lao)`,
	CASE cu.address_province WHEN 1 THEN 'ATP' -- ATTAPEU
		WHEN 2 THEN 'BK' -- BORKEO
		WHEN 3 THEN 'BKX' -- BORLIKHAMXAY
		WHEN 4 THEN 'CPS' -- CHAMPASACK
		WHEN 5 THEN 'HP' -- HOUAPHAN
		WHEN 6 THEN 'KM' -- KHAMMOUANE
		WHEN 7 THEN 'LNT' -- LUANGNAMTHA
		WHEN 8 THEN 'LPB' -- LUANGPRABANG
		WHEN 9 THEN 'ODX' -- OUDOMXAY
		WHEN 10 THEN 'PSL' -- PHONGSALY
		WHEN 11 THEN 'SLV' -- SALAVAN
		WHEN 12 THEN 'SV' -- SAVANNAKHET
		WHEN 13 THEN 'NKL' -- VIENTIANE CAPITAL
		WHEN 14 THEN 'VT' -- VIENTIANE PROVINCE
		WHEN 15 THEN 'XYL' -- XAYABOULY
		WHEN 16 THEN 'XSB' -- XAYSOMBOUN
		WHEN 17 THEN 'SK' -- SEKONG
		WHEN 18 THEN 'XKH' -- XIENGKHUANG
		ELSE ''
	END `address_province_code`,
	FROM_UNIXTIME(c.date_updated, '%d/%m/%Y %H:%m:%S') `datetime_updated`
FROM tblcustomer cu
RIGHT JOIN tblprospect p ON (p.customer_id = cu.id)
RIGHT JOIN tblcontract c ON (c.prospect_id = p.id)
left join tblcity ci on (ci.id = cu.address_city)
left join tblvillage v on (v.id = cu.address_village_id)
-- LEFT JOIN tbldailyreport dr ON  (dr.contract_id = c.id)
WHERE  p.status = 3 AND c.status in (4,6,7) -- AND dr.`date` = '2025-02-28'
	and c.contract_no in (2103223,2115595,2114379,2115668,2115700,2115732,2115687,2115725,2115652,2115688,2115748,2115750,2115752,2115754,2115753,2115678,2115704,2115694,2115721,2115740,2115658,2115662,2115724,2115713,2115717,2115738,2115741,2115743,2115744,2115745,2115746,2115739,2115747,2115680,2115690,2115695,2115698,2115699,2115707,2115709,2115711,2115720,2115823,2115653,2115667,2115884,2115628,2115871,2115903,2115948,2115900,2115956,2115868,2115967,2115921,2115957,2115554,2115618,2115836,2115961,2115772,2115627,2115919,2115890,2115911,2115824,2115944,2115934,2115926,2115873,2115908,2115947,2115991,2115839,2115563,2115895,2115997,2115878,2115998,2115949,2115157,2115892,2115989,2116006,2116008,2115981,2115942,2115969,2115988,2116004,2115201,2115984,2111026,2115928,2115923,2116031,2115929,2116024,2116005,2115999,2115965,2116014,2115913,2115976,2116018,2116037,2114142,2115980,2116021,2116038,2115978,2116033,2115916,2115951,2116026,2115539,2116020,2116009,2116011,2115534,2115958,2115987,2116022,2116019,2116015,2116036,2116042,2115938,2116068,2116075,2109360,2115912,2115585,2116051,2116029,2116032,2116034,2115971,2115347,2115932,2116060,2116013,2116059,2115968,2116076,2116041,2116083,2116096,2116066,2116055,2116072,2114663,2116100,2116101,2116078,2116057,2116074,2116098,2116086,2116070,2116115,2116012,2113930,2116027,2116063,2116069,2115925,2116130,2116048,2115802,2116112,2115561,2116137,2116081,2116105,2116044,2115351,2116049,2116103,2115905,2116102,2116007,2115993,2116106,2115887,2116153,2116168,2115990,2116156,2115897,2116147,2116061,2116161,2116163,2116088,2116043,2116082,2116146,2116128,2116124,2116095,2116148,2116132,2116140,2116173,2116170,2115371,2115872,2116152,2116142,2116129,2116171,2116125,2116169,2116139,2116145,2116150,2114498,2109896,2115190,2114219,2116155,2116158,2116191,2113819,2116203,2116206,2116178,2116186,2115441,2116119,2116196,2116215,2116160,2116234,2116184,2116093,2116131,2116183,2116085,2115438,2116209,2116141,2116224,2116232,2116238,2116231,2116222,2116211,2116194,2116223,2116240,2115805,2116242,2116228,2116179,2116241,2115964,2116111,2116274,2116197,2116285,2116250,2116218,2116181,2116201,2116226,2114522,2116214,2115960,2116023,2116247,2116277,2116225,2116135,2116282,2116252,2116229,2116172,2115808,2116205,2116261,2116265,2116028,2116219,2116243,2112963,2116175,2116180,2116244,2115187,2116263,2116256,2116259,2116293,2116297,2116079,2116267,2116239,2116287,2116262,2116318,2116272,2113761,2116319,2116273,2116326,2116336,2116246,2116337,2116463,2116306,2116286,2116313,2116321,2116230,2116300,2116325,2116270,2115917,2116199,2116307,2116494,2116385,2116404,2116413,2116419,2116414,2116415,2116481,2116483,2116539,2116540,2116541,2116542,2116237,2116561,2116207,2116557,2116299,2116271,2116496,2116576,2116304,2116448,2116331,2116567,2116258,2116563,2116582,2116578,2116368,2116056,2116317,2116583,2116593,2116311,2116560,2116345,2116278,2116565,2116387,2116338,2116312,2116400,2116315,2116612,2116605,2116597,2116568,2116580,2116118,2116296,2116601,2116590,2116614,2116303,2116269,2116585,2116616,2116571,2116617,2116591,2116294,2116606,2116628,2116645,2116626,2116620,2116647,2113465,2116523,2116524,2116635,2116632,2116526,2116636,2116530,2116531,2116656,2116493,2116600,2116570,2116631,2116638,2116577,2116327,2116648,2116637,2116138,2116675,2116669,2116622,2116642,2116664,2116190,2116650,2116251,2116697,2115838,2116347,2116677,2116654,2115415,2116700,2116447,2116680,2116679,2116670,2116710,2116689,2116692,2116709,2116658,2116663,2112856,2116726,2116733,2116659,2116359,2116386,2116433,2116236,2116736,2116640,2116484,2116695,2116681,2116340,2116349,2116515,2116350,2116512,2116352,2116510,2116406,2116501,2116420,2116478,2116421,2116425,2116427,2116429,2116432,2116718,2116428,2116426,2116487,2116403,2116473,2116444,2116470,2116469,2116450,2116373,2116468,2116739,2116721,2116492,2116423,2116745,2116701,2116348,2115952,2116482,2116767,2116485,2116502,2116714,2116475,2114794,2116763,2116416,2116550,2116551,2116552,2116528,2116464,2116766,2116465,2116467,2116472,2116516,2116431,2116518,2116517,2116371,2116375,2116208,2116372,2116586,2116775,2116750,2116769,2116716,2116796,2116755,2116686,2116777,2116727,2116154,2116374,2116725,2116440,2116699,2116765,2116772,2116824,2116553,2116790,2116801,2116757,2116356,2116392,2116511,2116731,2116784,2116507,2116509,2116779,2116760,2116787,2116803,2116715,2116840,2116741,2116792,2116819,2116831,2116761,2116737,2116751,2116820,2116813,2116816,2116797,2116773,2116549,2116344,2116828,2116394,2116395,2116639,2116860,2116543,2116811,2116836,2116788,2116661,2116807,2116547,2116162,2116764,2116833,2116743,2116795,2116525,2116800,2116471,2116844,2116603,2116845,2116812,2116866,2114800,2116873,2116830,2116878
)
ORDER BY c.contract_no ;



#CIB A5 as table (Ready to export)

-- insert A5 the old data from last month report 
insert into cib_report.tbla5 (`date_report`,`contract_no`,`bank_customer_ID`,`branch_ID_code`,`telephone_no`,`mobile_no`,`fax`,`datetime_updated`)
select '2025-02-28',`contract_no`,`bank_customer_ID`,`branch_ID_code`,`telephone_no`,`mobile_no`,`fax`,`datetime_updated`
from cib_report.tbla5 where date_report = '2025-01-31';

-- insert A5 the old data from LALCO live server
SELECT DISTINCT 
	-- dr.`date` `date_report`,
	'2025-02-28' `date_report`,
	c.contract_no ,
	case when length(c.ncn)>=6 then c.ncn when length(c.ncn)=5 then concat('0',c.ncn) when length(c.ncn)=4 then concat('00',c.ncn) else c.ncn end `bank_customer_ID`,
	CASE p.call_centre WHEN 1 THEN '01' ELSE '01' END `branch_ID_code`,
	CASE WHEN cu.main_contact_no = '' or cu.main_contact_no = 0 THEN '020'
		ELSE cu.main_contact_no
	END `telephone_no`,
	CASE WHEN cu.sec_contact_no = '' or  cu.sec_contact_no = 0 THEN cu.main_contact_no
		ELSE cu.sec_contact_no
	END `mobile_no`,
	'' `fax`,
	FROM_UNIXTIME(c.date_updated, '%d/%m/%Y %H:%m:%S') `datetime_updated`
FROM  tblcustomer cu
RIGHT JOIN tblprospect p ON (p.customer_id = cu.id)
RIGHT JOIN tblcontract c ON (c.prospect_id = p.id)
-- LEFT JOIN tbldailyreport dr ON  (dr.contract_id = c.id)
WHERE  p.status = 3 AND c.status in (4,6,7) -- AND dr.`date` = '2025-02-28'
	and c.contract_no in (2103223,2115595,2114379,2115668,2115700,2115732,2115687,2115725,2115652,2115688,2115748,2115750,2115752,2115754,2115753,2115678,2115704,2115694,2115721,2115740,2115658,2115662,2115724,2115713,2115717,2115738,2115741,2115743,2115744,2115745,2115746,2115739,2115747,2115680,2115690,2115695,2115698,2115699,2115707,2115709,2115711,2115720,2115823,2115653,2115667,2115884,2115628,2115871,2115903,2115948,2115900,2115956,2115868,2115967,2115921,2115957,2115554,2115618,2115836,2115961,2115772,2115627,2115919,2115890,2115911,2115824,2115944,2115934,2115926,2115873,2115908,2115947,2115991,2115839,2115563,2115895,2115997,2115878,2115998,2115949,2115157,2115892,2115989,2116006,2116008,2115981,2115942,2115969,2115988,2116004,2115201,2115984,2111026,2115928,2115923,2116031,2115929,2116024,2116005,2115999,2115965,2116014,2115913,2115976,2116018,2116037,2114142,2115980,2116021,2116038,2115978,2116033,2115916,2115951,2116026,2115539,2116020,2116009,2116011,2115534,2115958,2115987,2116022,2116019,2116015,2116036,2116042,2115938,2116068,2116075,2109360,2115912,2115585,2116051,2116029,2116032,2116034,2115971,2115347,2115932,2116060,2116013,2116059,2115968,2116076,2116041,2116083,2116096,2116066,2116055,2116072,2114663,2116100,2116101,2116078,2116057,2116074,2116098,2116086,2116070,2116115,2116012,2113930,2116027,2116063,2116069,2115925,2116130,2116048,2115802,2116112,2115561,2116137,2116081,2116105,2116044,2115351,2116049,2116103,2115905,2116102,2116007,2115993,2116106,2115887,2116153,2116168,2115990,2116156,2115897,2116147,2116061,2116161,2116163,2116088,2116043,2116082,2116146,2116128,2116124,2116095,2116148,2116132,2116140,2116173,2116170,2115371,2115872,2116152,2116142,2116129,2116171,2116125,2116169,2116139,2116145,2116150,2114498,2109896,2115190,2114219,2116155,2116158,2116191,2113819,2116203,2116206,2116178,2116186,2115441,2116119,2116196,2116215,2116160,2116234,2116184,2116093,2116131,2116183,2116085,2115438,2116209,2116141,2116224,2116232,2116238,2116231,2116222,2116211,2116194,2116223,2116240,2115805,2116242,2116228,2116179,2116241,2115964,2116111,2116274,2116197,2116285,2116250,2116218,2116181,2116201,2116226,2114522,2116214,2115960,2116023,2116247,2116277,2116225,2116135,2116282,2116252,2116229,2116172,2115808,2116205,2116261,2116265,2116028,2116219,2116243,2112963,2116175,2116180,2116244,2115187,2116263,2116256,2116259,2116293,2116297,2116079,2116267,2116239,2116287,2116262,2116318,2116272,2113761,2116319,2116273,2116326,2116336,2116246,2116337,2116463,2116306,2116286,2116313,2116321,2116230,2116300,2116325,2116270,2115917,2116199,2116307,2116494,2116385,2116404,2116413,2116419,2116414,2116415,2116481,2116483,2116539,2116540,2116541,2116542,2116237,2116561,2116207,2116557,2116299,2116271,2116496,2116576,2116304,2116448,2116331,2116567,2116258,2116563,2116582,2116578,2116368,2116056,2116317,2116583,2116593,2116311,2116560,2116345,2116278,2116565,2116387,2116338,2116312,2116400,2116315,2116612,2116605,2116597,2116568,2116580,2116118,2116296,2116601,2116590,2116614,2116303,2116269,2116585,2116616,2116571,2116617,2116591,2116294,2116606,2116628,2116645,2116626,2116620,2116647,2113465,2116523,2116524,2116635,2116632,2116526,2116636,2116530,2116531,2116656,2116493,2116600,2116570,2116631,2116638,2116577,2116327,2116648,2116637,2116138,2116675,2116669,2116622,2116642,2116664,2116190,2116650,2116251,2116697,2115838,2116347,2116677,2116654,2115415,2116700,2116447,2116680,2116679,2116670,2116710,2116689,2116692,2116709,2116658,2116663,2112856,2116726,2116733,2116659,2116359,2116386,2116433,2116236,2116736,2116640,2116484,2116695,2116681,2116340,2116349,2116515,2116350,2116512,2116352,2116510,2116406,2116501,2116420,2116478,2116421,2116425,2116427,2116429,2116432,2116718,2116428,2116426,2116487,2116403,2116473,2116444,2116470,2116469,2116450,2116373,2116468,2116739,2116721,2116492,2116423,2116745,2116701,2116348,2115952,2116482,2116767,2116485,2116502,2116714,2116475,2114794,2116763,2116416,2116550,2116551,2116552,2116528,2116464,2116766,2116465,2116467,2116472,2116516,2116431,2116518,2116517,2116371,2116375,2116208,2116372,2116586,2116775,2116750,2116769,2116716,2116796,2116755,2116686,2116777,2116727,2116154,2116374,2116725,2116440,2116699,2116765,2116772,2116824,2116553,2116790,2116801,2116757,2116356,2116392,2116511,2116731,2116784,2116507,2116509,2116779,2116760,2116787,2116803,2116715,2116840,2116741,2116792,2116819,2116831,2116761,2116737,2116751,2116820,2116813,2116816,2116797,2116773,2116549,2116344,2116828,2116394,2116395,2116639,2116860,2116543,2116811,2116836,2116788,2116661,2116807,2116547,2116162,2116764,2116833,2116743,2116795,2116525,2116800,2116471,2116844,2116603,2116845,2116812,2116866,2114800,2116873,2116830,2116878
)
ORDER BY c.contract_no ;



#CIB B1 as table

-- insert B1 the old data from LALCO live server
SELECT 
	dr.`date` `date_report`,
	c.contract_no ,
	case when length(c.ncn)>=6 then c.ncn when length(c.ncn)=5 then concat('0',c.ncn) when length(c.ncn)=4 then concat('00',c.ncn) else c.ncn end `bank_customer_ID`,
	CASE p.call_centre WHEN 1 THEN '01' ELSE '01' END `branch_ID_code`,
	c.contract_no `loan_ID`,
	CASE WHEN DATE_FORMAT(c.contract_date, '%d/%m/%Y') = '00/00/0000' THEN '01/01/1970'
		ELSE DATE_FORMAT(c.contract_date, '%d/%m/%Y')
	END `open_date`, 
	CASE WHEN DATE_FORMAT(p.last_payment_date, '%d/%m/%Y') = '00/00/0000' THEN '01/01/1970' 
		ELSE DATE_FORMAT(p.last_payment_date, '%d/%m/%Y')
	END `expiry_date`,
	'' `extension date`,
	p.monthly_interest /100 `interest_rate`,
	'CL' `purpose_code`,
	p.loan_amount `amount_of_loan`,
	p.trading_currency `currency_code`,
	case when c.contract_no in (2051043) then 0 else dr.total_principal_outstanding end `outstanding_balance`,
	'' `loan_account_number`,
	case when c.contract_no in (2051043) then 0 else dr.days_due end `number_of_days_slow`,
	CASE when c.contract_no in (2051043) then 'A'
		WHEN dr.days_due <= 30 THEN 'A'
		WHEN dr.days_due BETWEEN 31 AND 60 THEN 'B'
		WHEN dr.days_due BETWEEN 61 AND 90 THEN 'C'
		WHEN dr.days_due BETWEEN 91 AND 180 THEN 'D'
		ELSE 'E' -- > 180 days
	END `loan_class`,
	'CL' `loan_type`,
	CASE WHEN p.no_of_payment BETWEEN 0 AND 12 THEN 'ST'
		WHEN p.no_of_payment BETWEEN 13 AND 60 THEN 'MT'
		ELSE 'LT'
	END `loan_term`,
	case when c.contract_no in (2051043) then 'INACTIVE' 
		when dr.contract_status = 4 then 'ACTIVE' when dr.contract_status in (6,7) then 'INACTIVE' else 'INACTIVE' 
	END `loan_status`,
	DATE_FORMAT(dr.`date`, '%d/%m/%Y %H:%m:%s') `date_time_updated` 
FROM  tblcustomer cu
RIGHT JOIN tblprospect p ON  (p.customer_id = cu.id)
RIGHT JOIN tblcontract c ON  (c.prospect_id = p.id)
LEFT JOIN tbldailyreport dr ON  (dr.contract_id = c.id)
WHERE  p.status = 3 AND c.status in (4,6,7) AND dr.`date` = '2025-02-28'
 	and c.contract_no in (2103223,2115595,2114379,2115668,2115700,2115732,2115687,2115725,2115652,2115688,2115748,2115750,2115752,2115754,2115753,2115678,2115704,2115694,2115721,2115740,2115658,2115662,2115724,2115713,2115717,2115738,2115741,2115743,2115744,2115745,2115746,2115739,2115747,2115680,2115690,2115695,2115698,2115699,2115707,2115709,2115711,2115720,2115823,2115653,2115667,2115884,2115628,2115871,2115903,2115948,2115900,2115956,2115868,2115967,2115921,2115957,2115554,2115618,2115836,2115961,2115772,2115627,2115919,2115890,2115911,2115824,2115944,2115934,2115926,2115873,2115908,2115947,2115991,2115839,2115563,2115895,2115997,2115878,2115998,2115949,2115157,2115892,2115989,2116006,2116008,2115981,2115942,2115969,2115988,2116004,2115201,2115984,2111026,2115928,2115923,2116031,2115929,2116024,2116005,2115999,2115965,2116014,2115913,2115976,2116018,2116037,2114142,2115980,2116021,2116038,2115978,2116033,2115916,2115951,2116026,2115539,2116020,2116009,2116011,2115534,2115958,2115987,2116022,2116019,2116015,2116036,2116042,2115938,2116068,2116075,2109360,2115912,2115585,2116051,2116029,2116032,2116034,2115971,2115347,2115932,2116060,2116013,2116059,2115968,2116076,2116041,2116083,2116096,2116066,2116055,2116072,2114663,2116100,2116101,2116078,2116057,2116074,2116098,2116086,2116070,2116115,2116012,2113930,2116027,2116063,2116069,2115925,2116130,2116048,2115802,2116112,2115561,2116137,2116081,2116105,2116044,2115351,2116049,2116103,2115905,2116102,2116007,2115993,2116106,2115887,2116153,2116168,2115990,2116156,2115897,2116147,2116061,2116161,2116163,2116088,2116043,2116082,2116146,2116128,2116124,2116095,2116148,2116132,2116140,2116173,2116170,2115371,2115872,2116152,2116142,2116129,2116171,2116125,2116169,2116139,2116145,2116150,2114498,2109896,2115190,2114219,2116155,2116158,2116191,2113819,2116203,2116206,2116178,2116186,2115441,2116119,2116196,2116215,2116160,2116234,2116184,2116093,2116131,2116183,2116085,2115438,2116209,2116141,2116224,2116232,2116238,2116231,2116222,2116211,2116194,2116223,2116240,2115805,2116242,2116228,2116179,2116241,2115964,2116111,2116274,2116197,2116285,2116250,2116218,2116181,2116201,2116226,2114522,2116214,2115960,2116023,2116247,2116277,2116225,2116135,2116282,2116252,2116229,2116172,2115808,2116205,2116261,2116265,2116028,2116219,2116243,2112963,2116175,2116180,2116244,2115187,2116263,2116256,2116259,2116293,2116297,2116079,2116267,2116239,2116287,2116262,2116318,2116272,2113761,2116319,2116273,2116326,2116336,2116246,2116337,2116463,2116306,2116286,2116313,2116321,2116230,2116300,2116325,2116270,2115917,2116199,2116307,2116494,2116385,2116404,2116413,2116419,2116414,2116415,2116481,2116483,2116539,2116540,2116541,2116542,2116237,2116561,2116207,2116557,2116299,2116271,2116496,2116576,2116304,2116448,2116331,2116567,2116258,2116563,2116582,2116578,2116368,2116056,2116317,2116583,2116593,2116311,2116560,2116345,2116278,2116565,2116387,2116338,2116312,2116400,2116315,2116612,2116605,2116597,2116568,2116580,2116118,2116296,2116601,2116590,2116614,2116303,2116269,2116585,2116616,2116571,2116617,2116591,2116294,2116606,2116628,2116645,2116626,2116620,2116647,2113465,2116523,2116524,2116635,2116632,2116526,2116636,2116530,2116531,2116656,2116493,2116600,2116570,2116631,2116638,2116577,2116327,2116648,2116637,2116138,2116675,2116669,2116622,2116642,2116664,2116190,2116650,2116251,2116697,2115838,2116347,2116677,2116654,2115415,2116700,2116447,2116680,2116679,2116670,2116710,2116689,2116692,2116709,2116658,2116663,2112856,2116726,2116733,2116659,2116359,2116386,2116433,2116236,2116736,2116640,2116484,2116695,2116681,2116340,2116349,2116515,2116350,2116512,2116352,2116510,2116406,2116501,2116420,2116478,2116421,2116425,2116427,2116429,2116432,2116718,2116428,2116426,2116487,2116403,2116473,2116444,2116470,2116469,2116450,2116373,2116468,2116739,2116721,2116492,2116423,2116745,2116701,2116348,2115952,2116482,2116767,2116485,2116502,2116714,2116475,2114794,2116763,2116416,2116550,2116551,2116552,2116528,2116464,2116766,2116465,2116467,2116472,2116516,2116431,2116518,2116517,2116371,2116375,2116208,2116372,2116586,2116775,2116750,2116769,2116716,2116796,2116755,2116686,2116777,2116727,2116154,2116374,2116725,2116440,2116699,2116765,2116772,2116824,2116553,2116790,2116801,2116757,2116356,2116392,2116511,2116731,2116784,2116507,2116509,2116779,2116760,2116787,2116803,2116715,2116840,2116741,2116792,2116819,2116831,2116761,2116737,2116751,2116820,2116813,2116816,2116797,2116773,2116549,2116344,2116828,2116394,2116395,2116639,2116860,2116543,2116811,2116836,2116788,2116661,2116807,2116547,2116162,2116764,2116833,2116743,2116795,2116525,2116800,2116471,2116844,2116603,2116845,2116812,2116866,2114800,2116873,2116830,2116878
)
ORDER BY c.contract_no ;

-- ___________________________________ B1 if not data in table daily report _______________________________________
-- insert B1 the old data from LALCO live server
SELECT 
	'2025-02-28' `date_report`,
	c.contract_no ,
	case when length(c.ncn)>=6 then c.ncn when length(c.ncn)=5 then concat('0',c.ncn) when length(c.ncn)=4 then concat('00',c.ncn) else c.ncn end `bank_customer_ID`,
	CASE p.call_centre WHEN 1 THEN '01' ELSE '01' END `branch_ID_code`,
	c.contract_no `loan_ID`,
	CASE WHEN DATE_FORMAT(c.contract_date, '%d/%m/%Y') = '00/00/0000' THEN '01/01/1970'
		ELSE DATE_FORMAT(c.contract_date, '%d/%m/%Y')
	END `open_date`, 
	CASE WHEN DATE_FORMAT(p.last_payment_date, '%d/%m/%Y') = '00/00/0000' THEN '01/01/1970' 
		ELSE DATE_FORMAT(p.last_payment_date, '%d/%m/%Y')
	END `expiry_date`,
	'' `extension date`,
	p.monthly_interest /100 `interest_rate`,
	'CL' `purpose_code`,
	p.loan_amount `amount_of_loan`,
	p.trading_currency `currency_code`,
	case when c.contract_no in (2051043) then 0 else po.principal_outstanding end `outstanding_balance`,
	'' `loan_account_number`,
	case when c.contract_no in (2051043) then 0 
		WHEN c.status in (6,7) THEN 0 WHEN p.first_payment_date >= '2025-02-28' THEN 0 
		WHEN c.status = 4 and DATEDIFF('2025-02-28', date_add(ps.payment_date, interval + 1 month) ) + 1 <=0 then 0
		WHEN c.status = 4 THEN DATEDIFF('2025-02-28', case when ps.payment_date is null then p.first_payment_date else date_add(ps.payment_date, interval + 1 month) end) + 1
	end `number_of_days_slow`,
	CASE when c.contract_no in (2051043) then 'A'
		WHEN c.status in (6,7) THEN 'A'
		WHEN p.first_payment_date >= '2025-02-28' THEN 'A'
		WHEN c.status = 4 and DATEDIFF('2025-02-28', case when ps.payment_date is null then p.first_payment_date else date_add(ps.payment_date, interval + 1 month) end) + 1 <= 30 THEN 'A'
		WHEN c.status = 4 and DATEDIFF('2025-02-28', case when ps.payment_date is null then p.first_payment_date else date_add(ps.payment_date, interval + 1 month) end) + 1 BETWEEN 31 AND 60 THEN 'B'
		WHEN c.status = 4 and DATEDIFF('2025-02-28', case when ps.payment_date is null then p.first_payment_date else date_add(ps.payment_date, interval + 1 month) end) + 1 BETWEEN 61 AND 90 THEN 'C'
		WHEN c.status = 4 and DATEDIFF('2025-02-28', case when ps.payment_date is null then p.first_payment_date else date_add(ps.payment_date, interval + 1 month) end) + 1 BETWEEN 91 AND 180 THEN 'D'
		ELSE 'E'
	END `loan_class`,
	'CL' `loan_type`,
	CASE WHEN p.no_of_payment BETWEEN 0 AND 12 THEN 'ST'
		WHEN p.no_of_payment BETWEEN 13 AND 60 THEN 'MT'
		ELSE 'LT'
	END `loan_term`,
	case when c.contract_no in (2051043) then 'INACTIVE' 
		when c.status = 4 then 'ACTIVE' when c.status in (6,7) then 'INACTIVE' else 'INACTIVE' 
	END `loan_status`,
	DATE_FORMAT('2025-02-28', '%d/%m/%Y %H:%m:%s') `date_time_updated` 
FROM  tblcustomer cu
RIGHT JOIN tblprospect p ON  (p.customer_id = cu.id)
RIGHT JOIN tblcontract c ON  (c.prospect_id = p.id)
left join (select c.contract_no, SUM(case when pm.`type` = 'principal' then pm.amount - pm.paid_amount - (pm.refinance_amount + pm.void_amount) end) 'principal_outstanding'
			from tblcontract c left join tblpayment pm on (pm.contract_id = c.id) group by c.contract_no 
		  ) po on (po.contract_no = c.contract_no)
LEFT JOIN tblpaymentschedule ps ON ps.id = (SELECT id FROM tblpaymentschedule WHERE status = 1 and payment_amount !=0 and contract_id = c.id ORDER BY payment_date DESC LIMIT 1)
WHERE  p.status = 3 AND c.status in (4,6,7) 
  and c.contract_no in ()
ORDER BY c.contract_no ; 



#C1 as table

-- insert C1 the old data from last month report 
insert into cib_report.tblc1 (`date_report`,`contract_no`,`bank_customer_ID`,`branch_ID_code`,`loan_ID`,`collateral_ID`,`owner_gender`,`owner_1st_name_(english)`,`owner 2nd_name_(english)`,`owner_surname_(english)`,`owner_1st_name_(lao)`,`owner_surname_(lao)`,`collateral_type`,`collateral_value`,`currency_code`,`collateral_status`,`date_time_updated`)
select '2025-02-28',`contract_no`,`bank_customer_ID`,`branch_ID_code`,`loan_ID`,`collateral_ID`,`owner_gender`,`owner_1st_name_(english)`,`owner 2nd_name_(english)`,`owner_surname_(english)`,`owner_1st_name_(lao)`,`owner_surname_(lao)`,`collateral_type`,`collateral_value`,`currency_code`,`collateral_status`,`date_time_updated`
from cib_report.tblc1 where date_report = '2025-01-31';

-- insert C1 the old data from LALCO live server
SELECT 
	-- dr.`date` `date_report`,
	'2025-02-28' `date_report`,
	c.contract_no ,
	case when length(c.ncn)>=6 then c.ncn when length(c.ncn)=5 then concat('0',c.ncn) when length(c.ncn)=4 then concat('00',c.ncn) else c.ncn end `bank_customer_ID`,
	CASE p.call_centre WHEN 1 THEN '01' ELSE '01' END `branch_ID_code`,
	c.contract_no `loan_ID`,
	av.id `collateral_ID`,
	'M' `owner_gender`,
	'Yoshihito' `owner_1st_name_(english)`,
	'' `owner 2nd_name_(english)`,
	'OSHIMA' `owner_surname_(english)`,
	'ໂຢຊິຮິໂຕ' `owner_1st_name_(lao)`,
	'ໂອຊິມາ' `owner_surname_(lao) `,
	'C2.5' `collateral_type`,
	av.min_buying_price `collateral_value`,
	'USD' `currency_code`,
	case when c.contract_no in (2051043) then 'INACTIVE' 
		-- when dr.contract_status = 4 then 'ACTIVE' when dr.contract_status in (6,7) then 'INACTIVE' else 'INACTIVE' 
	END `collateral_status`,
	FROM_UNIXTIME(av.date_updated, '%d/%m/%Y %H:%m:%s')  `date_time_updated`  
FROM  tblcustomer cu
RIGHT JOIN tblprospect p ON (p.customer_id = cu.id)
RIGHT JOIN tblcontract c ON (c.prospect_id = p.id)
LEFT JOIN tblprospectasset pa ON  (p.id = pa.prospect_id)
LEFT JOIN tblassetvaluation av ON (av.id = pa.assetvaluation_id)
LEFT JOIN tblcar car ON  (car.id = av.collateral_car_id)
-- LEFT JOIN tbldailyreport dr ON  (dr.contract_id = c.id)
WHERE  p.status = 3 AND c.status in (4,6,7) -- AND dr.`date` = '2025-02-28' 
	and c.contract_no in (2103223,2115595,2114379,2115668,2115700,2115732,2115687,2115725,2115652,2115688,2115748,2115750,2115752,2115754,2115753,2115678,2115704,2115694,2115721,2115740,2115658,2115662,2115724,2115713,2115717,2115738,2115741,2115743,2115744,2115745,2115746,2115739,2115747,2115680,2115690,2115695,2115698,2115699,2115707,2115709,2115711,2115720,2115823,2115653,2115667,2115884,2115628,2115871,2115903,2115948,2115900,2115956,2115868,2115967,2115921,2115957,2115554,2115618,2115836,2115961,2115772,2115627,2115919,2115890,2115911,2115824,2115944,2115934,2115926,2115873,2115908,2115947,2115991,2115839,2115563,2115895,2115997,2115878,2115998,2115949,2115157,2115892,2115989,2116006,2116008,2115981,2115942,2115969,2115988,2116004,2115201,2115984,2111026,2115928,2115923,2116031,2115929,2116024,2116005,2115999,2115965,2116014,2115913,2115976,2116018,2116037,2114142,2115980,2116021,2116038,2115978,2116033,2115916,2115951,2116026,2115539,2116020,2116009,2116011,2115534,2115958,2115987,2116022,2116019,2116015,2116036,2116042,2115938,2116068,2116075,2109360,2115912,2115585,2116051,2116029,2116032,2116034,2115971,2115347,2115932,2116060,2116013,2116059,2115968,2116076,2116041,2116083,2116096,2116066,2116055,2116072,2114663,2116100,2116101,2116078,2116057,2116074,2116098,2116086,2116070,2116115,2116012,2113930,2116027,2116063,2116069,2115925,2116130,2116048,2115802,2116112,2115561,2116137,2116081,2116105,2116044,2115351,2116049,2116103,2115905,2116102,2116007,2115993,2116106,2115887,2116153,2116168,2115990,2116156,2115897,2116147,2116061,2116161,2116163,2116088,2116043,2116082,2116146,2116128,2116124,2116095,2116148,2116132,2116140,2116173,2116170,2115371,2115872,2116152,2116142,2116129,2116171,2116125,2116169,2116139,2116145,2116150,2114498,2109896,2115190,2114219,2116155,2116158,2116191,2113819,2116203,2116206,2116178,2116186,2115441,2116119,2116196,2116215,2116160,2116234,2116184,2116093,2116131,2116183,2116085,2115438,2116209,2116141,2116224,2116232,2116238,2116231,2116222,2116211,2116194,2116223,2116240,2115805,2116242,2116228,2116179,2116241,2115964,2116111,2116274,2116197,2116285,2116250,2116218,2116181,2116201,2116226,2114522,2116214,2115960,2116023,2116247,2116277,2116225,2116135,2116282,2116252,2116229,2116172,2115808,2116205,2116261,2116265,2116028,2116219,2116243,2112963,2116175,2116180,2116244,2115187,2116263,2116256,2116259,2116293,2116297,2116079,2116267,2116239,2116287,2116262,2116318,2116272,2113761,2116319,2116273,2116326,2116336,2116246,2116337,2116463,2116306,2116286,2116313,2116321,2116230,2116300,2116325,2116270,2115917,2116199,2116307,2116494,2116385,2116404,2116413,2116419,2116414,2116415,2116481,2116483,2116539,2116540,2116541,2116542,2116237,2116561,2116207,2116557,2116299,2116271,2116496,2116576,2116304,2116448,2116331,2116567,2116258,2116563,2116582,2116578,2116368,2116056,2116317,2116583,2116593,2116311,2116560,2116345,2116278,2116565,2116387,2116338,2116312,2116400,2116315,2116612,2116605,2116597,2116568,2116580,2116118,2116296,2116601,2116590,2116614,2116303,2116269,2116585,2116616,2116571,2116617,2116591,2116294,2116606,2116628,2116645,2116626,2116620,2116647,2113465,2116523,2116524,2116635,2116632,2116526,2116636,2116530,2116531,2116656,2116493,2116600,2116570,2116631,2116638,2116577,2116327,2116648,2116637,2116138,2116675,2116669,2116622,2116642,2116664,2116190,2116650,2116251,2116697,2115838,2116347,2116677,2116654,2115415,2116700,2116447,2116680,2116679,2116670,2116710,2116689,2116692,2116709,2116658,2116663,2112856,2116726,2116733,2116659,2116359,2116386,2116433,2116236,2116736,2116640,2116484,2116695,2116681,2116340,2116349,2116515,2116350,2116512,2116352,2116510,2116406,2116501,2116420,2116478,2116421,2116425,2116427,2116429,2116432,2116718,2116428,2116426,2116487,2116403,2116473,2116444,2116470,2116469,2116450,2116373,2116468,2116739,2116721,2116492,2116423,2116745,2116701,2116348,2115952,2116482,2116767,2116485,2116502,2116714,2116475,2114794,2116763,2116416,2116550,2116551,2116552,2116528,2116464,2116766,2116465,2116467,2116472,2116516,2116431,2116518,2116517,2116371,2116375,2116208,2116372,2116586,2116775,2116750,2116769,2116716,2116796,2116755,2116686,2116777,2116727,2116154,2116374,2116725,2116440,2116699,2116765,2116772,2116824,2116553,2116790,2116801,2116757,2116356,2116392,2116511,2116731,2116784,2116507,2116509,2116779,2116760,2116787,2116803,2116715,2116840,2116741,2116792,2116819,2116831,2116761,2116737,2116751,2116820,2116813,2116816,2116797,2116773,2116549,2116344,2116828,2116394,2116395,2116639,2116860,2116543,2116811,2116836,2116788,2116661,2116807,2116547,2116162,2116764,2116833,2116743,2116795,2116525,2116800,2116471,2116844,2116603,2116845,2116812,2116866,2114800,2116873,2116830,2116878
)
ORDER BY c.contract_no ;


-- update collateral status
select * from cib_report.tblc1 c1 join cib_report.tblb1 b1 on (c1.contract_no = b1.contract_no and c1.date_report = '2025-02-28' and b1.date_report = c1.date_report) 
where c1.`collateral_status` = '' or c1.`collateral_status` != b1.`loan_status`;


update cib_report.tblc1 c1 join cib_report.tblb1 b1 on (c1.contract_no = b1.contract_no and c1.date_report = '2025-02-28' and b1.date_report = c1.date_report) 
set c1.`collateral_status` = b1.`loan_status`;

/*
#CIB C2.1 as table 

-- insert C2.1 the old data from LALCO live server
select 
	'2025-02-28' `date_report`,
	c.contract_no ,
	case when length(c.ncn)>=6 then c.ncn when length(c.ncn)=5 then concat('0',c.ncn) when length(c.ncn)=4 then concat('00',c.ncn) end  `bank_customer_ID`,
	case p.call_centre when 1 then '01' else '01' end `branch_ID_code`,
	c.contract_no `loan_ID`,
	concat('SBR', avl.id) `collateral_ID`,
	avl.land_estimated_price `value`,
	convert(cast(convert(avl.deed_no using latin1) as binary) using utf8) `land_number`, 
	avl.land_area `land_size`,
	'M2' `land_unit`,
	avl.map_no `land_mapcode`,
	DATE_FORMAT(avl.land_register_date, '%d/%m/%Y') `land_title_date`,
	v.village_name `location_number_and_street_(english)`,
	v.village_name `location_village_(english)`,
	ci.city_name `location_distrcit_(english)`,
	convert(cast(convert(v.village_name_lao using latin1) as binary) using utf8) `location_number_and_street_(lao)`,
	convert(cast(convert(v.village_name_lao using latin1) as binary) using utf8) `location_village_(lao)`,
	convert(cast(convert(ci.city_name_lao using latin1) as binary) using utf8) `location_distrcit_(lao)`,
	case avl.land_province_id when 1 then 'ATP' -- ATTAPEU
		when 2 then 'BK' -- BORKEO
		when 3 then 'BKX' -- BORLIKHAMXAY
		when 4 then 'CPS' -- CHAMPASACK
		when 5 then 'HP' -- HOUAPHAN
		when 6 then 'KM' -- KHAMMOUANE
		when 7 then 'LNT' -- LUANGNAMTHA
		when 8 then 'LPB' -- LUANGPRABANG
		when 9 then 'ODX' -- OUDOMXAY
		when 10 then 'PSL' -- PHONGSALY
		when 11 then 'SLV' -- SALAVAN
		when 12 then 'SV' -- SAVANNAKHET
		when 13 then 'NKL' -- VIENTIANE CAPITAL
		when 14 then 'VT' -- VIENTIANE PROVINCE
		when 15 then 'XYL' -- XAYABOULY
		when 16 then 'XSB' -- XAYSOMBOUN
		when 17 then 'SK' -- SEKONG
		when 18 then 'XKH' -- XIENGKHUANG
		else ''
	end `location_province_code`
from  tblcustomer cu
right join tblprospect p on (p.customer_id = cu.id)
right join tblcontract c on (c.prospect_id = p.id)
left join tblprospectassetland pa on  (p.id = pa.prospect_id)
left join tblassetvaluationland avl on (avl.id = pa.assetvaluation_land_id)
left join tblprovince pv on (pv.id = avl.land_province_id)
left join tblcity ci on (ci.id=avl.land_city_id)
left join tblvillage v on (v.id=avl.land_village_id)
-- LEFT JOIN tbldailyreport dr ON  (dr.contract_id = c.id)
where p.contract_type = 5 and p.status = 3 and c.status in (4,6,7) -- AND dr.`date` = '2022-11-30'
	and c.contract_no in ()
order by c.contract_no ;
*/


#CIB C2.5 as table 

-- insert C2.5 the old data from last month report 
insert into cib_report.`tblc2.5` (`date_report`,`contract_no`,`bank_customer_ID`,`branch_ID_code`,`loan_ID`,`collateral_ID`,`plate_number`,`engine_number`,`body_number`,`model`,`value`)
select '2025-02-28',`contract_no`,`bank_customer_ID`,`branch_ID_code`,`loan_ID`,`collateral_ID`,`plate_number`,`engine_number`,`body_number`,`model`,`value`
from cib_report.`tblc2.5` where date_report = '2025-01-31';

-- insert C2.5 the old data from LALCO live server
SELECT 
	'2025-02-28' `date_report`,
	c.contract_no ,
	case when length(c.ncn)>=6 then c.ncn when length(c.ncn)=5 then concat('0',c.ncn) when length(c.ncn)=4 then concat('00',c.ncn) end  `bank_customer_ID`,
	CASE p.call_centre WHEN 1 THEN '01' ELSE '01' END `branch_ID_code`,
	c.contract_no `loan_ID`,
	av.id `collateral_ID`,
	case when convert(cast(convert(av.number_plate using latin1) as binary) using utf8) is null then 'No'
		else convert(cast(convert(av.number_plate using latin1) as binary) using utf8) 
	end `plate_number`,
	case when av.collateral_engine_no = '' THEN 'No' ELSE av.collateral_engine_no 
	END `engine_number`, -- tblassetvaluation status (0 = Draft, 1 = Pending Assessment, 2 = Asset Assessed, 3 = Cancelled, 4 = Deleted)
	case when av.collateral_vin_code = '' THEN 'Novincode' ELSE av.collateral_vin_code END `body_number`,
	car.car_make `model`,
	av.valuation_amount `value`
FROM  tblcustomer cu
RIGHT JOIN tblprospect p ON (p.customer_id = cu.id)
RIGHT JOIN tblcontract c ON (c.prospect_id = p.id)
LEFT JOIN tblprospectasset pa ON  (p.id = pa.prospect_id)
LEFT JOIN tblassetvaluation av ON (av.id = pa.assetvaluation_id)
LEFT JOIN tblcar car ON  (car.id = av.collateral_car_id)
-- LEFT JOIN tbldailyreport dr ON  (dr.contract_id = c.id)
WHERE  p.status = 3 AND c.status in (4,6,7) -- AND dr.`date` = '2025-02-28'
	and c.contract_no in (2103223,2115595,2114379,2115668,2115700,2115732,2115687,2115725,2115652,2115688,2115748,2115750,2115752,2115754,2115753,2115678,2115704,2115694,2115721,2115740,2115658,2115662,2115724,2115713,2115717,2115738,2115741,2115743,2115744,2115745,2115746,2115739,2115747,2115680,2115690,2115695,2115698,2115699,2115707,2115709,2115711,2115720,2115823,2115653,2115667,2115884,2115628,2115871,2115903,2115948,2115900,2115956,2115868,2115967,2115921,2115957,2115554,2115618,2115836,2115961,2115772,2115627,2115919,2115890,2115911,2115824,2115944,2115934,2115926,2115873,2115908,2115947,2115991,2115839,2115563,2115895,2115997,2115878,2115998,2115949,2115157,2115892,2115989,2116006,2116008,2115981,2115942,2115969,2115988,2116004,2115201,2115984,2111026,2115928,2115923,2116031,2115929,2116024,2116005,2115999,2115965,2116014,2115913,2115976,2116018,2116037,2114142,2115980,2116021,2116038,2115978,2116033,2115916,2115951,2116026,2115539,2116020,2116009,2116011,2115534,2115958,2115987,2116022,2116019,2116015,2116036,2116042,2115938,2116068,2116075,2109360,2115912,2115585,2116051,2116029,2116032,2116034,2115971,2115347,2115932,2116060,2116013,2116059,2115968,2116076,2116041,2116083,2116096,2116066,2116055,2116072,2114663,2116100,2116101,2116078,2116057,2116074,2116098,2116086,2116070,2116115,2116012,2113930,2116027,2116063,2116069,2115925,2116130,2116048,2115802,2116112,2115561,2116137,2116081,2116105,2116044,2115351,2116049,2116103,2115905,2116102,2116007,2115993,2116106,2115887,2116153,2116168,2115990,2116156,2115897,2116147,2116061,2116161,2116163,2116088,2116043,2116082,2116146,2116128,2116124,2116095,2116148,2116132,2116140,2116173,2116170,2115371,2115872,2116152,2116142,2116129,2116171,2116125,2116169,2116139,2116145,2116150,2114498,2109896,2115190,2114219,2116155,2116158,2116191,2113819,2116203,2116206,2116178,2116186,2115441,2116119,2116196,2116215,2116160,2116234,2116184,2116093,2116131,2116183,2116085,2115438,2116209,2116141,2116224,2116232,2116238,2116231,2116222,2116211,2116194,2116223,2116240,2115805,2116242,2116228,2116179,2116241,2115964,2116111,2116274,2116197,2116285,2116250,2116218,2116181,2116201,2116226,2114522,2116214,2115960,2116023,2116247,2116277,2116225,2116135,2116282,2116252,2116229,2116172,2115808,2116205,2116261,2116265,2116028,2116219,2116243,2112963,2116175,2116180,2116244,2115187,2116263,2116256,2116259,2116293,2116297,2116079,2116267,2116239,2116287,2116262,2116318,2116272,2113761,2116319,2116273,2116326,2116336,2116246,2116337,2116463,2116306,2116286,2116313,2116321,2116230,2116300,2116325,2116270,2115917,2116199,2116307,2116494,2116385,2116404,2116413,2116419,2116414,2116415,2116481,2116483,2116539,2116540,2116541,2116542,2116237,2116561,2116207,2116557,2116299,2116271,2116496,2116576,2116304,2116448,2116331,2116567,2116258,2116563,2116582,2116578,2116368,2116056,2116317,2116583,2116593,2116311,2116560,2116345,2116278,2116565,2116387,2116338,2116312,2116400,2116315,2116612,2116605,2116597,2116568,2116580,2116118,2116296,2116601,2116590,2116614,2116303,2116269,2116585,2116616,2116571,2116617,2116591,2116294,2116606,2116628,2116645,2116626,2116620,2116647,2113465,2116523,2116524,2116635,2116632,2116526,2116636,2116530,2116531,2116656,2116493,2116600,2116570,2116631,2116638,2116577,2116327,2116648,2116637,2116138,2116675,2116669,2116622,2116642,2116664,2116190,2116650,2116251,2116697,2115838,2116347,2116677,2116654,2115415,2116700,2116447,2116680,2116679,2116670,2116710,2116689,2116692,2116709,2116658,2116663,2112856,2116726,2116733,2116659,2116359,2116386,2116433,2116236,2116736,2116640,2116484,2116695,2116681,2116340,2116349,2116515,2116350,2116512,2116352,2116510,2116406,2116501,2116420,2116478,2116421,2116425,2116427,2116429,2116432,2116718,2116428,2116426,2116487,2116403,2116473,2116444,2116470,2116469,2116450,2116373,2116468,2116739,2116721,2116492,2116423,2116745,2116701,2116348,2115952,2116482,2116767,2116485,2116502,2116714,2116475,2114794,2116763,2116416,2116550,2116551,2116552,2116528,2116464,2116766,2116465,2116467,2116472,2116516,2116431,2116518,2116517,2116371,2116375,2116208,2116372,2116586,2116775,2116750,2116769,2116716,2116796,2116755,2116686,2116777,2116727,2116154,2116374,2116725,2116440,2116699,2116765,2116772,2116824,2116553,2116790,2116801,2116757,2116356,2116392,2116511,2116731,2116784,2116507,2116509,2116779,2116760,2116787,2116803,2116715,2116840,2116741,2116792,2116819,2116831,2116761,2116737,2116751,2116820,2116813,2116816,2116797,2116773,2116549,2116344,2116828,2116394,2116395,2116639,2116860,2116543,2116811,2116836,2116788,2116661,2116807,2116547,2116162,2116764,2116833,2116743,2116795,2116525,2116800,2116471,2116844,2116603,2116845,2116812,2116866,2114800,2116873,2116830,2116878
)
ORDER BY c.contract_no ;

-- check
select * from cib_report.tbla1 where date_report = '2025-02-28';
select * from cib_report.tbla4 where date_report = '2025-02-28';
select * from cib_report.tbla5 where date_report = '2025-02-28';
select * from cib_report.tblb1 where date_report = '2025-02-28';
select * from cib_report.tblc1 where date_report = '2025-02-28';
-- select * from cib_report.`tblc2.1` where date_report = '2025-02-28';
select * from cib_report.`tblc2.5` where date_report = '2025-02-28';



-- 3) Export to report 
-- export A1
select concat_ws('|','A1',`bank_customer_ID`,`branch_ID_code`,`group_ID`,`head_of_group`,`national_ID`,`national_ID_expiry_date`,`passport_number`,`passport_expiry_date`,`familybook`,`family_province_code_if_issue`,`family_issue_date`,`birthdate`,`1st_name_(english)`,`2nd_name_(english)`,`surname_(english)`,`1st_name_(lao)`,`surname_(lao)`,`old _surname_(english)`,`old_surname_(lao)`,`nationality`,`gender`,`civil_status`,`spouse_1st_(english)`,`spouse_2nd_(english)`,`spouse_surname_(english)`,`spouse_1st_(lao)`,`spouse_surname_(lao)`,`datetime_updated`)
from cib_report.tbla1 
where date_report = '2025-02-28' ;


-- export A4
select concat_ws('|','A4',`bank_customer_ID`,`branch_ID_code`,`address_number_and_street_(english)`,`address_village_(english)`,`address_district_(english)`,`address_number_and_street_(lao)`,`address_village_(lao)`,`address_district_(lao)`,`address_province_code`,`datetime_updated`)
from cib_report.tbla4
where date_report = '2025-02-28' ;


-- export A5
select concat_ws('|','A5',`bank_customer_ID`,`branch_ID_code`,`telephone_no`,`mobile_no`,`fax`,`datetime_updated`)
from cib_report.tbla5
where date_report = '2025-02-28' ;


-- export B1
select concat_ws('|','B1',`bank_customer_ID`,`branch_ID_code`,`loan_ID`,`open_date`,`expiry_date`,`extension_date`,`interest_rate`,`purpose_code`,`amount_of_loan`,`currency_code`,`outstanding_balance`,`loan_account_number`,`number_of_days_slow`,`loan_class`,`loan_type`,`loan_term`,`loan_status`,`date_time_updated`)
from cib_report.tblb1
where date_report = '2025-02-28' ;


-- export C1
select concat_ws('|','C1',`bank_customer_ID`,`branch_ID_code`,`loan_ID`,`collateral_ID`,`owner_gender`,`owner_1st_name_(english)`,`owner 2nd_name_(english)`,`owner_surname_(english)`,`owner_1st_name_(lao)`,`owner_surname_(lao)`,`collateral_type`,`collateral_value`,`currency_code`,`collateral_status`,`date_time_updated`)
from cib_report.tblc1
where date_report = '2025-02-28' ;


-- export C2.5
select concat_ws('|','C2.5',`bank_customer_ID`,`branch_ID_code`,`loan_ID`,`collateral_ID`,`plate_number`,`engine_number`,`body_number`,`model`,`value`)
from cib_report.`tblc2.5`
where date_report = '2025-02-28' ;


-- ________________________________________________________ User & Password ________________________________________________________

https://mf.lcic.com.la/


1	ນ.ຕຽງຄຳ ຈັນທະວົງ	Mrs Tiengkham CHANTHAVONG	ຜູ້ອານຸມັດ	ສິິນເຊື່ອ	ບ. ສະພັງໝໍ້, ມ. ໄຊເສດຖາ, ນວ	020 29400630
User: 415.010318.TIENGKHAM 
Password: 3300

2	ນ ມຸກປະກາຍ ປັນຍານຸວົງ	Ms Moukpakay PANYANOUVONG	ຜູ້ອານຸມັດ	ສິິນເຊື່ອ	ບ. ໂພນທັນ, ມ. ໄຊເສດຖາ, ນວ	020 98712682
User: 415.010319.MOUKPAKAY 
Password: 8822

3	ນ.ກຸ້ງນາງ ພົມມະຫາ	Mrs Koungnang PHOMMAHA	ຜູ້ອານຸມັດ	ສິິນເຊື່ອ	ບ. ໂພນຕ້ອງສະຫວາດ, ມ. ຈັນທະບູລີ, ນວ	020 54967888
User: 415.010108.KOUNGNANG 
Password: 8888

4	ນ.ກຸ້ງນາງ ແກ້ວວົງໄຊ	Ms Koungnang KEOVONGXAI	ຜູ້ອານຸມັດ	ສິິນເຊື່ອ	ບ. ດ່ານຊ້າງ, ມ. ໄຊທານີ, ນວ	020 77536373
User: 415.010626.KOUNGNANG 
Password: 7733

5	ນ. ສາລຸນາ ຄຳແພງ	Mrs Salouna KHAMPHENG	ຜູ້ອານຸມັດ	ສິິນເຊື່ອ	ບ. ໂຊກຄຳ, ມ. ໄຊເສດຖາ, ນວ	020 96635332
User: 415.010327.SALOUNA
Password: 3322

6	ນ. ລັດຕະນະພອນ ໄຊຍະແສງ	Mrs Lattanaphone XAYASENG	ຜູ້ອານຸມັດ	ສິິນເຊື່ອ	ບ. ພະຂາວ, ມ. ໄຊທານີ, ນວ	020 92222409
User: 415.010634.LATTANAPHONE
Password: 0099

7	ທ. ຄຳວາງ ຈື່ຊະ	Mr Khamvang CHUESA	ໄອທີ	ອັບເດດຂໍ້ມູນ	ບ. ດອນກອຍ, ມ. ສີສັດຕະນາກ, ນວ	020 29301330
User: 415.010426.KHAMVANG
Password: 3300

8	ທ. ຕົງຈົວ ຢາຈົວໂຈເລີ Mr Tongjoua Yahjouachaipler	ໄອທີ	ອັບເດດຂໍ້ມູນ	ບ. ສະພານທອງເໜືອ, ມ. ສີສັດຕະນາກ, ນວ	020 29917549
User: 415.010750.MANOP
Password: 0088

9	ທ. ມານົບ ຈັນທະໂພລີ	Manop CHANTHAPHOLY	ໄອທີ	ອັບເດດຂໍ້ມູນ	ບ. ທ່າພະ, ມ.ຫາດຊາຍຟອງ, ນວ	020 91065908
User: 415.010639.YONGYEELOR
Password: 5522

10	ນາງ ຄຳພິກ ອິນທະວົງ	Ms. Khamphik INTHAVONG	ສິນເຊື່ອ	
User: 415.1759.Kham
Password: 444

11	ນ ສຸດຕາ ວົງເລືອງຄຳ	Ms Soutta VONGLEUANGKHAM	ສິນເຊື່ອ	
User: 415.1336.Ta
Password: 123


12	ນ ສິລິພອນ ຫຼວງລາດ	Ms Siliphone LUANGLATH	ສິນເຊື່ອ	
User: 415.139.Si
Password: 456






-- Old users

User: 415.1233.Aek
Password: 111

User: 415.1233.Some
Password: 222

User: 415.1257.Ou
Password: 333

User: 415.1759.Kham
Password: 444

User: 415.1218.Tha -- ບໍ່ໄດເ
Password: 555

User: 415.6951.Sout
Password: 666

User: 415.16123.Seng -- ບໍ່ໄດ້
Password: 777

User: 415.1636.Souk
Password: 888

User: 415.1335.Bun
Password: 999

User: 415.1336.Ta
Password: 123

User: 415.139.Si
Password: 456

User: 415.1628.Nisa
Password: 789


1	ທ.ເອກ ພອນວິໄລ	Mr Aek phonevilai	ສິນເຊື່ອ	415.1233.Aek	111 >> ອອກວຽກແລ້ວ
2	ທ.ສົມໃຈ ສົມນຶກ	Mr Somjai somnuek	ສິນເຊື່ອ	415.1233.Som	222 >> ອອກວຽກແລ້ວ
3	ທ ອຸລາດ ເພັດທະໜອມ	Mr Oulard PHENGTHANOM	ສິນເຊື່ອ	415.1257.Ou	333 >> ອອກວຽກແລ້ວ
4	ນາງ ຄຳພິກ ອິນທະວົງ	Ms. Khamphik INTHAVONG	ສິນເຊື່ອ	415.1759.Kham	444 
5	ທ ທະວີສັກ ແກ້ວວົງສາ	Mr Thavisack KEOVONGSA	ສິນເຊື່ອ	415.1218.Tha	555 >> ອອກວຽກແລ້ວ
6	ນ ສຸຸດທະນາ ຈັນທະມາລີ	Ms SOUTHANA CHANTHAMALY	ສິນເຊື່ອ	415.6951.Sout	666 >> ອອກວຽກແລ້ວ
7	ນ ມະນີແສງ ສາຍຈູມມະນີ	Ms Manyseng SAYCHOUMMANY	ສິນເຊື່ອ	415.16123.Seng	777 >> ອອກວຽກແລ້ວ
8	ນາງ ສຸກສະຫວັນ ບຸນມະໄລ	MS Souksavanh Bounmalay	ສິນເຊື່ອ	514.1636.Souk	888 >> ອອກວຽກແລ້ວ
9	ທ້າວ ບັ່ນ ແກ້ວດວງຕາ	Mr Bun keoduangta	ສິນເຊື່ອ	415.1335.Bun	999 >> ອອກວຽກແລ້ວ
10	ນ ສຸດຕາ ວົງເລືອງຄຳ	Ms Soutta VONGLEUANGKHAM	ສິນເຊື່ອ	415.1336.Ta	123
11	ນ ສິລິພອນ ຫຼວງລາດ	Ms Siliphone LUANGLATH	ສິນເຊື່ອ	415.139.Si	456 
12	ນາງ ນິສາ ມຽງເຮືອງທອງ	Ms Nisa miengheuangthong	ສິນເຊື່ອ	415.1628.Nisa	789 >> ອອກວຽກແລ້ວ




select concat(a1.`1st_name_(lao)` ,' ', a1.`surname_(lao)`) `customer_name`, 
	b1.loan_ID , b1.loan_ID , b1.open_date , b1.expiry_date , b1.amount_of_loan , b1.outstanding_balance ,
	concat('Model: ', c2.model, ', Engine no: ', c2.engine_number, ', Vin code: ', c2.body_number  ) `collateral`,
	c2.value , 'ບ້ວງເງິນກູ້' `objective`, b1.interest_rate * 12 * 100 `rate`, b1.number_of_days_slow , b1.loan_class ,
	b1.loan_status 
from cib_report.tbla1 a1 left join cib_report.tblb1 b1 on (a1.contract_no = b1.contract_no and a1.date_report = b1.date_report)
left join cib_report.`tblc2.5` c2 on (c2.contract_no = a1.contract_no and c2.date_report = a1.date_report)
where b1.contract_no = '2087241' and a1.date_report = '2025-02-28' ;




-- ___________________________________ LCIC requests to update last data on LCIC web server  ___________________________________
-- example: http://redmine.lalco.la/issues/3061

-- Old data, run from the data that submit last time
select '415' `Bank_ID`, `bank_customer_ID`, `branch_ID_code`, `loan_ID`, '' `loan_account_number`, `open_date`, `expiry_date`, '00/00/0000' `extension_date`, `interest_rate`,
	`purpose_code`, `amount_of_loan`, `outstanding_balance`, `currency_code`, `number_of_days_slow`, `loan_class`, `loan_type`, `loan_term`, `loan_status`,`date_time_updated`
from cib_report.tblb1 where contract_no = 2090898 and date_report = '2025-02-28';


-- New data, run from LALCO live server database to update when LCIC request
select '415' `Bank_ID`,
	case when length(c.ncn)>=6 then c.ncn when length(c.ncn)=5 then concat('0',c.ncn) when length(c.ncn)=4 then concat('00',c.ncn) end `bank_customer_ID`,
	case p.call_centre when 1 then '01' else '01' end `branch_ID_code`,
	c.contract_no `loan_ID`,
	''  `loan_account_number`,
	case when DATE_FORMAT(c.contract_date, '%d/%m/%Y') = '00/00/0000' then '01/01/1970'
		else DATE_FORMAT(c.contract_date, '%d/%m/%Y')
	end `open_date`, 
	case when DATE_FORMAT(p.last_payment_date, '%d/%m/%Y') = '00/00/0000' then '01/01/1970' 
		else DATE_FORMAT(p.last_payment_date, '%d/%m/%Y')
	end `expiry_date`,
	'00/00/0000' `extension date`,
	round(p.monthly_interest /100, 2) `interest_rate`,
	'CL' `purpose_code`,
	p.loan_amount `amount_of_loan`,
	case when c.contract_no in (2051043) then 0 else dr.total_principal_outstanding end `outstanding_balance`,
	p.trading_currency `currency_code`,
	case when c.contract_no in (2051043) then 0 else dr.days_due end `number_of_days_slow`,
	case when c.contract_no in (2051043) then 'A'
		when dr.days_due = 0 then 'A'
		when dr.days_due between 1 and 30 then 'B'
		when dr.days_due between 31 and 90 then 'C'
		when dr.days_due between 91 and 180 then 'D'
		else 'E'
	end `loan_class`,
	'CL' `loan_type`,
	case when p.no_of_payment between 0 and 12 then 'ST'
		when p.no_of_payment between 13 and 60 then 'MT'
		else 'LT'
	end `loan_term`,
	case when c.contract_no in (2051043) then 'INACTIVE' 
		when dr.contract_status = 4 then 'ACTIVE' when dr.contract_status in (6,7) then 'INACTIVE' else 'INACTIVE' 
	end `loan_status`,
	DATE_FORMAT(dr.`date`, '%d/%m/%Y %H:%m:%s') `date_time_updated` 
from tblcustomer cu
right join tblprospect p on  (p.customer_id = cu.id)
right join tblcontract c on  (c.prospect_id = p.id)
left join tbldailyreport dr on  (dr.contract_id = c.id)
where p.status = 3 and c.status in (4,6,7) and dr.`date` = '2023-07-17' -- date need to update
 	and c.contract_no in (2090898) -- contract_no need to update
order by c.contract_no ;











# Other query
-- update business owner name
update table cib_report.tblc1 set `owner_1st_name_(english)` = 'Shingo', `owner_surname_(english)` = 'YAMANAKA', `owner_1st_name_(lao)` = 'ຊິໂກ', `owner_surname_(lao)` = 'ຢາມານາກາ'
where date_report = '2025-02-28';

update cib_report.tblc1 set `owner_1st_name_(english)` = 'Yoshihito', `owner_surname_(english)` = 'OSHIMA', `owner_1st_name_(lao)` = 'ໂຢຊິຮິໂຕ', `owner_surname_(lao)` = 'ໂອຊິມາ'
where date_report = '2025-02-28';


-- update customer phone numbers

update tbla5 set telephone_no = 
	case when (length (regexp_replace(telephone_no , '[^[:digit:]]', '')) = 9 and left (regexp_replace(telephone_no , '[^[:digit:]]', ''),3) = '021')
			or (length (regexp_replace(telephone_no , '[^[:digit:]]', '')) = 8 and left (regexp_replace(telephone_no , '[^[:digit:]]', ''),2) = '21' )
			or (length (regexp_replace(telephone_no , '[^[:digit:]]', '')) = 6)
		then concat('021',right(regexp_replace(telephone_no , '[^[:digit:]]', ''),6)) -- for 021
		when (length (regexp_replace(telephone_no , '[^[:digit:]]', '')) = 11 and left (regexp_replace(telephone_no , '[^[:digit:]]', ''),3) = '020')
			or (length (regexp_replace(telephone_no , '[^[:digit:]]', '')) = 10 and left (regexp_replace(telephone_no , '[^[:digit:]]', ''),2) = '20')
			or (length (regexp_replace(telephone_no , '[^[:digit:]]', '')) = 8 and left (regexp_replace(telephone_no , '[^[:digit:]]', ''),1) in ('2','5','7','8','9'))
		then concat('020',right(regexp_replace(telephone_no , '[^[:digit:]]', ''),8)) -- for 020
		when (length (regexp_replace(telephone_no , '[^[:digit:]]', '')) = 10 and left (regexp_replace(telephone_no , '[^[:digit:]]', ''),3) = '030')
			or (length (regexp_replace(telephone_no , '[^[:digit:]]', '')) = 9 and left (regexp_replace(telephone_no , '[^[:digit:]]', ''),2) = '30')
			or (length (regexp_replace(telephone_no , '[^[:digit:]]', '')) = 7 and left (regexp_replace(telephone_no , '[^[:digit:]]', ''),1) in ('2','4','5','7','9'))
		then concat('030',right(regexp_replace(telephone_no , '[^[:digit:]]', ''),7)) -- for 030
		when left (right (regexp_replace(telephone_no , '[^[:digit:]]', ''),8),1) in ('0','1','') then concat('030',right(regexp_replace(telephone_no , '[^[:digit:]]', ''),7))
		when left (right (regexp_replace(telephone_no , '[^[:digit:]]', ''),8),1) in ('2','5','7','8','9')
		then concat('020',right(regexp_replace(telephone_no , '[^[:digit:]]', ''),8))
		else concat('020',right(regexp_replace(telephone_no , '[^[:digit:]]', ''),8))
	end 
where date_report = '2022-05-31' 

update tbla5 set mobile_no = 
	case when (length (regexp_replace(mobile_no , '[^[:digit:]]', '')) = 9 and left (regexp_replace(mobile_no , '[^[:digit:]]', ''),3) = '021')
			or (length (regexp_replace(mobile_no , '[^[:digit:]]', '')) = 8 and left (regexp_replace(mobile_no , '[^[:digit:]]', ''),2) = '21' )
			or (length (regexp_replace(mobile_no , '[^[:digit:]]', '')) = 6)
		then concat('021',right(regexp_replace(mobile_no , '[^[:digit:]]', ''),6)) -- for 021
		when (length (regexp_replace(mobile_no , '[^[:digit:]]', '')) = 11 and left (regexp_replace(mobile_no , '[^[:digit:]]', ''),3) = '020')
			or (length (regexp_replace(mobile_no , '[^[:digit:]]', '')) = 10 and left (regexp_replace(mobile_no , '[^[:digit:]]', ''),2) = '20')
			or (length (regexp_replace(mobile_no , '[^[:digit:]]', '')) = 8 and left (regexp_replace(mobile_no , '[^[:digit:]]', ''),1) in ('2','5','7','8','9'))
		then concat('020',right(regexp_replace(mobile_no , '[^[:digit:]]', ''),8)) -- for 020
		when (length (regexp_replace(mobile_no , '[^[:digit:]]', '')) = 10 and left (regexp_replace(mobile_no , '[^[:digit:]]', ''),3) = '030')
			or (length (regexp_replace(mobile_no , '[^[:digit:]]', '')) = 9 and left (regexp_replace(mobile_no , '[^[:digit:]]', ''),2) = '30')
			or (length (regexp_replace(mobile_no , '[^[:digit:]]', '')) = 7 and left (regexp_replace(mobile_no , '[^[:digit:]]', ''),1) in ('2','4','5','7','9'))
		then concat('030',right(regexp_replace(mobile_no , '[^[:digit:]]', ''),7)) -- for 030
		when left (right (regexp_replace(mobile_no , '[^[:digit:]]', ''),8),1) in ('0','1','') then concat('030',right(regexp_replace(mobile_no , '[^[:digit:]]', ''),7))
		when left (right (regexp_replace(mobile_no , '[^[:digit:]]', ''),8),1) in ('2','5','7','8','9')
		then concat('020',right(regexp_replace(mobile_no , '[^[:digit:]]', ''),8))
		else concat('020',right(regexp_replace(mobile_no , '[^[:digit:]]', ''),8))
	end 
where date_report = '2022-05-31' 



-- update loan_ID for date report 2022-08-31
select * from cib_report.tblb1 where date_report = '2022-08-31' and  contract_no in (2076261,2077218,2077385,2077789,2078118,2078423,2078430,2081253,2081773,2081815,2084046,2084205,2084994,2085190,2085326,2085633,2085649,2085800,2085812,2085949,2086303,2086314,2086333,2086374,2086405,2086406,2086407,2086422,2086451,2086454,2086459,2086494,2086498,2086499,2086503,2086519,2086526,2086528,2086537,2086561,2086590,2086601,2086604,2086608,2086612,2086614,2086620,2086625,2086626,2086637,2086643,2086649,2086655,2086658,2086664,2086692,2086702,2086707,2086710,2086716,2086717,2086736,2086759,2086767,2086785,2086786,2086789,2086797,2086800,2086804,2086813,2086816,2086823,2086831,2086842,2086845,2086852,2086856,2086875,2086895,2086897,2086905,2086923,2086928,2086930,2086932,2086935,2086944,2086950,2086962,2086966,2086975,2086992,2086993,2086996,2087000,2087003,2087013,2087020,2087025,2087031,2087033,2087034,2087036,2087050,2087057,2087063,2087073,2087074,2087075,2087083,2087109,2087115,2087118,2087119,2087125,2087127,2087128,2087135,2087137,2087139,2087156,2087174,2087183,2087185,2087190,2087194,2087195,2087206,2087207,2087208,2087214,2087218,2087230,2087234,2087235,2087236,2087239,2087244,2087247,2087253,2087267,2087269,2087277,2087282,2087283,2087284,2087286,2087287,2087289,2087292,2087296,2087299,2087300,2087302,2087312,2087313,2087321,2087325,2087326,2087332,2087333,2087335,2087338,2087341,2087345,2087347,2087353,2087355,2087361,2087363,2087364,2087366,2087368,2087370,2087371,2087372,2087373,2087375,2087376,2087377,2087378,2087380,2087382,2087386,2087387,2087389,2087390,2087392,2087393,2087394,2087395,2087398,2087401,2087402,2087403,2087407,2087409,2087410,2087411,2087412,2087414,2087415,2087416,2087417,2087418,2087419,2087420,2087422,2087423,2087425,2087426,2087427,2087428,2087430,2087432,2087433,2087435,2087436,2087437,2087439,2087440,2087442,2087443,2087444,2087451,2087452,2087453,2087454,2087455,2087456,2087458,2087459,2087461,2087463,2087465,2087466,2087467,2087468,2087469,2087470,2087471,2087474,2087475,2087478,2087479,2087480,2087481,2087482,2087483,2087484,2087486,2087488,2087489,2087490,2087492,2087493,2087495,2087496,2087497,2087499,2087500,2087501,2087502,2087503,2087509,2087510,2087511,2087512,2087513,2087514,2087517,2087518,2087519,2087520,2087522,2087523,2087524,2087525,2087526,2087527,2087531,2087534,2087535,2087536,2087537,2087538,2087540,2087541,2087542,2087543,2087544,2087545,2087546,2087547,2087548,2087550,2087551,2087552,2087553,2087554,2087555,2087556,2087557,2087558,2087559,2087560,2087561,2087562,2087563,2087565,2087566,2087567,2087568,2087571,2087572,2087573,2087574,2087576,2087579,2087581,2087584,2087585,2087586,2087587,2087588,2087589,2087590,2087592,2087593,2087594,2087595,2087598,2087600,2087601,2087603,2087606,2087607,2087609,2087610,2087611,2087613,2087614,2087615,2087616,2087617,2087618,2087619,2087621,2087622,2087623,2087624,2087625,2087626,2087627,2087628,2087630,2087631,2087632,2087633,2087634,2087635,2087636,2087637,2087638,2087640,2087641,2087642,2087643,2087644,2087645,2087646,2087647,2087648,2087649,2087650,2087651,2087652,2087653,2087655,2087656,2087657,2087658,2087659,2087660,2087661,2087662,2087664,2087665,2087666,2087667,2087668,2087669,2087670,2087671,2087672,2087673,2087674,2087675,2087676,2087680,2087681,2087683,2087685,2087687,2087688,2087689,2087690,2087692,2087693,2087694,2087695,2087696,2087697,2087699,2087701,2087703,2087704,2087705,2087707,2087708,2087709,2087710,2087711,2087713,2087714,2087715,2087718,2087719,2087721,2087724,2087727,2087728,2087729,2087730,2087731,2087732,2087733,2087735,2087736,2087738,2087739,2087740,2087741,2087742,2087743,2087745,2087747,2087748,2087749,2087750,2087751,2087752,2087753,2087754,2087755,2087756,2087757,2087758,2087759,2087761,2087762,2087763,2087764,2087768,2087771,2087772,2087773,2087774,2087776,2087777,2087778,2087782,2087783,2087785,2087788,2087789,2087790,2087791,2087793,2087794,2087796,2087797,2087798,2087800,2087802,2087803,2087804,2087805,2087806,2087808,2087810,2087812,2087814,2087815,2087816,2087817,2087820,2087823,2087824,2087828,2087829,2087831,2087832,2087833,2087835,2087836,2087837,2087839,2087840,2087841,2087842,2087843,2087845,2087846,2087850,2087851,2087852,2087853,2087856,2087858,2087859,2087863,2087864,2087865,2087867,2087869,2087870,2087872,2087875,2087877,2087878,2087880,2087881,2087882,2087883,2087885,2087886,2087887,2087888,2087889,2087890,2087891,2087892,2087893,2087894,2087895,2087899,2087900,2087901,2087902,2087906,2087907,2087908,2087910,2087911,2087912,2087913,2087914,2087915,2087916,2087917,2087918,2087920,2087921,2087923,2087924,2087925,2087928,2087929,2087930,2087931,2087934,2087935,2087936,2087939,2087941,2087945,2087946,2087949,2087950,2087952,2087953,2087955,2087958,2087959,2087961,2087965,2087967,2087969,2087970,2087971,2087973,2087974,2087975,2087976,2087977,2087979,2087981,2087982,2087983,2087984,2087985,2087986,2087989,2087991,2087992,2087993,2087995,2087996,2087998,2087999,2088000,2088001,2088002,2088004,2088005,2088006,2088007,2088008,2088011,2088012,2088013,2088014,2088015,2088016,2088017,2088018,2088020,2088024,2088025,2088030,2088031,2088032,2088033,2088034,2088037,2088038,2088039,2088040,2088041,2088042,2088044,2088046,2088047,2088048,2088050,2088051,2088054,2088056,2088057,2088058,2088059,2088061,2088062,2088064,2088065,2088066,2088067,2088068,2088069,2088072,2088074,2088075,2088076,2088078,2088081,2088082,2088083,2088084,2088085,2088086,2088087,2088088,2088089,2088090,2088091,2088092,2088093,2088095,2088096,2088097,2088099,2088100,2088102,2088103,2088104,2088105,2088107,2088108,2088109,2088110,2088111,2088112,2088115,2088118,2088119,2088120,2088122,2088123,2088124,2088128,2088129,2088137,2088138,2088140,2088141,2088144,2088145,2088146,2088148,2088150,2088152,2088155,2088156,2088158,2088160,2088162,2088163,2088164,2088165,2088166,2088171,2088174,2088175,2088176,2088177,2088178,2088179,2088180,2088181,2088183,2088184,2088185,2088188,2088189,2088190,2088191,2088192,2088193,2088194,2088196,2088197,2088198,2088199,2088200,2088201,2088203,2088206,2088207,2088208,2088211,2088212,2088213,2088215,2088216,2088219,2088221,2088222,2088223,2088225,2088226,2088227,2088228,2088229,2088230,2088231,2088232,2088234,2088235,2088238,2088239,2088240,2088241,2088243,2088245,2088246,2088247,2088249,2088250,2088251,2088252,2088255,2088256,2088259,2088260,2088261,2088262,2088264,2088266,2088270,2088273,2088274,2088275,2088278,2088281,2088283,2088285,2088286,2088290,2088291,2088292,2088293,2088294,2088297,2088302,2088304,2088305,2088306,2088307,2088309,2088314,2088316,2088318,2088319,2088322,2088326,2088327,2088328,2088330,2088332,2088334,2088335,2088337,2088339,2088341,2088344,2088345,2088346,2088347,2088349,2088350,2088351,2088352,2088353,2088354,2088355,2088356,2088359,2088361,2088362,2088366,2088368,2088371,2088372,2088373,2088374,2088375,2088376,2088377,2088378,2088381,2088384,2088385,2088386,2088387,2088389,2088391,2088392,2088395,2088396,2088397,2088400,2088402,2088405,2088407,2088408,2088410,2088412,2088417,2088418,2088419,2088424,2088428,2088429,2088431,2088432,2088434,2088436,2088438,2088439,2088444,2088446,2088447,2088449,2088450,2088451,2088452,2088453,2088457,2088458,2088459,2088460,2088461,2088462,2088463,2088464,2088467,2088468,2088471,2088473,2088474,2088476,2088477,2088478,2088481,2088482,2088484,2088488,2088489,2088492,2088494,2088496,2088505,2088506,2088508,2088509,2088527,2088530,2088534,2076779,2077686,2082449,2084613,2085053,2085298,2085775,2085869,2086119,2086967,2087211,2087408,2087464,2087583,2087786,2087787,2087897,2087944,2087997,2088021,2088070,2088153,2088161,2088220,2088237,2088254,2088271,2088272,2088277,2088288,2088296,2088313,2088340,2088365,2088367,2088370,2088383,2088388,2088403,2088406,2088411,2088414,2088420,2088421,2088425,2088430,2088433,2088435,2088441,2088443,2088445,2088448,2088454,2088466,2088469,2088470,2088475,2088479,2088483,2088490,2088493,2088495,2088497,2088498,2088499,2088500,2088501,2088503,2088504,2088511,2088514,2088515,2088516,2088519,2088520,2088521,2088523,2088524,2088525,2088528,2088529,2088531,2088536,2088537,2088544,2088545,2088546,2088547,2088548,2088549,2088550,2088551,2088552,2088553,2088555,2088556,2088557,2088559,2088560,2088561,2088562,2088564,2088565,2088566,2088567,2088568,2088569,2088572,2088573,2088574,2088575,2088576,2088577,2088579,2088580,2088581,2088582,2088583,2088584,2088585,2088586,2088588,2088589,2088591,2088592,2088593,2088594,2088597,2088598,2088599,2088600,2088602,2088603,2088604,2088610,2088613,2088614,2088617,2088618,2088619,2088620,2088621,2088622,2088623,2088624,2088625,2088626,2088627,2088628,2088629,2088631,2088632,2088633,2088634,2088635,2088636,2088637,2088639,2088641,2088643,2088644,2088645,2088647,2088650,2088651,2088652,2088653,2088656,2088658,2088661,2088662,2088663,2088664,2088665,2088666,2088667,2088668,2088671,2088672,2088673,2088677,2088678,2088679,2088680,2088681,2088682,2088683,2088686,2088688,2088689,2088692,2088693,2088694,2088695,2088697,2088698,2088699,2088700,2088702,2088703,2088707,2088708,2088712,2088713,2088715,2088716,2088717,2088718,2088723,2088724,2088725,2088729,2088730,2088731,2088733,2088734,2088735,2088736,2088738,2088740,2088742,2088743,2088744,2088745,2088747,2088748,2088749,2088750,2088754,2088755,2088757,2088758,2088759,2088760,2088761,2088763,2088764,2088765,2088773,2088774,2088775,2088777,2088778,2088782,2088783,2088784,2088787,2088788,2088789,2088791,2088794,2088795,2088800,2088802,2088804,2088806,2088808,2088812,2088814,2088815,2088816,2088818,2088819,2088820,2088821,2088825,2088826,2088828,2088830,2088831,2088832,2088833,2088834,2088835,2088837,2088838,2088840,2088841,2088842,2088843,2088844,2088845,2088846,2088849,2088850,2088851,2088852,2088854,2088856,2088857,2088858,2088859,2088861,2088862,2088865,2088866,2088867,2088868,2088869,2088871,2088873,2088874,2088875,2088876,2088877,2088878,2088879,2088880,2088881,2088882,2088883,2088885,2088886,2088887,2088888,2088889,2088891,2088894,2088895,2088897,2088898,2088899,2088900,2088901,2088902,2088903,2088904,2088905,2088906,2088907,2088909,2088910,2088912,2088914,2088916,2088917,2088919,2088920,2088921,2088922,2088924,2088925,2088926,2088927,2088929,2088930,2088931,2088932,2088935,2088936,2088937,2088939,2088940,2088941,2088942,2088943,2088946,2088947,2088948,2088949,2088950,2088952,2088954,2088956,2088958,2088959,2088960,2088961,2088962,2088963,2088964,2088965,2088967,2088968,2088969,2088970,2088972,2088973,2088974,2088975,2088977,2088978,2088980,2088981,2088982,2088983,2088984,2088985,2088987,2088989,2088990,2088991,2088993,2088995,2088997,2088999,2089002,2089003,2089004,2089006,2089008,2089009,2089011,2089013,2089014,2089015,2089017,2089019,2089021,2089024,2089026,2089030,2089032,2089033,2089034,2089038,2089039,2089040,2089041,2089047,2089048,2089049,2089050,2089051,2089052,2089053,2089055,2089056,2089058,2089059,2089062,2089063,2089066,2089067,2089068,2089069,2089072,2089073,2089074,2089075,2089077,2089080,2089083,2089084,2089085,2089088,2089089,2089094,2089096,2089097,2089099,2089100,2089102,2089103,2089104,2089106,2089107,2089110,2089111,2089112,2089113,2089115,2089117,2089118,2089119,2089120,2089121,2089123,2089124,2089126,2089127,2089128,2089129,2089131,2089134,2089138,2089139,2089140,2089141,2089142,2089143,2089144,2089146,2089147,2089148,2089150,2089151,2089152,2089153,2089154,2089156,2089160,2089161,2089163,2089164,2089165,2089166,2089167,2089168,2089169,2089171,2089172,2089173,2089175,2089176,2089177,2089180,2089181,2089182,2089183,2089184,2089185,2089186,2089187,2089188,2089190,2089192,2089193,2089194,2089197,2089198,2089201,2089204,2089205,2089206,2089209,2089210,2089213,2089214,2089216,2089217,2089218,2089219,2089220,2089222,2089223,2089225,2089226,2089228,2089230,2089231,2089233,2089234,2089237,2089238,2089239,2089241,2089242,2089243,2089246,2089247,2089248,2089249,2089252,2089255,2089259,2089261,2089264,2089265,2089266,2089269,2089270,2089272,2089273,2089274,2089276,2089277,2089279,2089281,2089282,2089283,2089286,2089288,2089291,2089292,2089293,2089295,2089296,2089299,2089302,2089304,2089306,2089307,2089308,2089309,2089310,2089311,2089312,2089314,2089315,2089316,2089317,2089319,2089321,2089324,2089325,2089326,2089329,2089332,2089333,2089335,2089337,2089338,2089340,2089341,2089343,2089346,2089347,2089349,2089352,2089353,2089355,2089356,2089357,2089359,2089360,2089361,2089362,2089363,2089366,2089368,2089369,2089370,2089373,2089374,2089375,2089377,2089378,2089379,2089381,2089384,2089385,2089388,2089393,2089394,2089398,2089399,2089401,2089404,2089407,2089408,2089410,2089411,2089412,2089414,2089416,2089422,2089428,2089430,2089432,2089433,2089434,2089435,2089437,2089438,2089441,2089443,2089452,2089453,2089456,2089458,2089460,2089463,2089464,2089467,2089468,2089470,2089480,2089483,2089484,2089486,2089489,2089501,2089504,2089514,2089516,2089519,2042063,2067865,2076481,2078956,2081057,2081640,2082932,2083881,2084062,2084265,2085196,2086052,2086213,2087123,2087485,2087580,2087838,2088063,2088136,2088308,2088338,2088539,2088542,2088752,2088769,2088809,2088811,2088892,2088971,2088988,2089025,2089028,2089037,2089065,2089191,2089278,2089328,2089348,2089364,2089365,2089376,2089383,2089386,2089387,2089396,2089397,2089402,2089403,2089405,2089415,2089417,2089420,2089421,2089424,2089436,2089439,2089444,2089446,2089447,2089449,2089451,2089457,2089459,2089462,2089472,2089475,2089477,2089485,2089488,2089495,2089496,2089497,2089499,2089502,2089503,2089506,2089507,2089508,2089509,2089510,2089512,2089515,2089517,2089520,2089524,2089525,2089526,2089527,2089528,2089529,2089530,2089531,2089532,2089533,2089536,2089537,2089539,2089540,2089541,2089542,2089543,2089545,2089546,2089548,2089549,2089550,2089551,2089554,2089555,2089556,2089557,2089559,2089560,2089562,2089564,2089565,2089566,2089570,2089571,2089572,2089573,2089575,2089576,2089577,2089578,2089579,2089580,2089581,2089582,2089584,2089585,2089586,2089587,2089589,2089593,2089595,2089596,2089598,2089599,2089600,2089603,2089605,2089606,2089607,2089608,2089609,2089610,2089611,2089612,2089613,2089614,2089615,2089616,2089617,2089618,2089619,2089623,2089624,2089625,2089627,2089629,2089631,2089633,2089634,2089635,2089636,2089637,2089638,2089639,2089640,2089641,2089643,2089645,2089646,2089647,2089648,2089649,2089650,2089651,2089652,2089655,2089656,2089657,2089658,2089660,2089661,2089662,2089663,2089664,2089665,2089667,2089668,2089669,2089670,2089672,2089674,2089675,2089676,2089677,2089682,2089687,2089688,2089689,2089691,2089692,2089693,2089694,2089695,2089696,2089699,2089700,2089702,2089704,2089705,2089706,2089707,2089711,2089714,2089715,2089719,2089721,2089724,2089726,2089727,2089729,2089730,2089731,2089734,2089737,2089738,2089739,2089740,2089741,2089742,2089743,2089745,2089746,2089747,2089748,2089749,2089750,2089751,2089752,2089753,2089754,2089756,2089757,2089758,2089759,2089761,2089762,2089763,2089764,2089765,2089766,2089769,2089770,2089771,2089772,2089773,2089775,2089776,2089777,2089778,2089779,2089780,2089781,2089782,2089783,2089785,2089786,2089788,2089789,2089791,2089793,2089794,2089795,2089796,2089798,2089800,2089803,2089804,2089805,2089807,2089809,2089810,2089811,2089812,2089813,2089814,2089818,2089820,2089821,2089822,2089823,2089824,2089826,2089827,2089829,2089830,2089831,2089832,2089833,2089835,2089836,2089838,2089842,2089844,2089845,2089848,2089849,2089850,2089851,2089852,2089853,2089854,2089857,2089861,2089863,2089866,2089867,2089868,2089871,2089872,2089873,2089875,2089876,2089877,2089879,2089882,2089883,2089884,2089885,2089886,2089887,2089888,2089889,2089891,2089892,2089894,2089895,2089896,2089897,2089899,2089902,2089904,2089905,2089907,2089910,2089912,2089913,2089914,2089915,2089916,2089917,2089918,2089919,2089922,2089924,2089925,2089926,2089928,2089929,2089930,2089932,2089933,2089936,2089938,2089939,2089941,2089943,2089944,2089945,2089947,2089950,2089951,2089952,2089953,2089954,2089955,2089958,2089961,2089963,2089966,2089970,2089971,2089975,2089976,2089978,2089980,2089981,2089983,2089985,2089988,2089990,2089991,2089993,2089995,2089996,2089997,2089998,2089999,2090000,2090002,2090003,2090004,2090006,2090007,2090008,2090009,2090010,2090012,2090013,2090014,2090016,2090019,2090021,2090022,2090024,2090026,2090027,2090029,2090032,2090037,2090040,2090043,2090045,2090048,2090049,2090050,2090057,2090058,2090059,2090060,2090063,2090064,2090065,2090067,2090069,2090070,2090071,2090074,2090076,2090077,2090079,2090080,2090081,2090083,2090084,2090085,2090087,2090088,2090089,2090090,2090091,2090092,2090093,2090095,2090098,2090099,2090101,2090102,2090105,2090106,2090108,2090109,2090112,2090113,2090114,2090115,2090116,2090117,2090119,2090120,2090121,2090122,2090123,2090124,2090125,2090127,2090129,2090130,2090131,2090134,2090135,2090137,2090139,2090140,2090141,2090143,2090144,2090145,2090147,2090148,2090149,2090151,2090152,2090153,2090155,2090156,2090157,2090158,2090160,2090163,2090166,2090168,2090169,2090170,2090172,2090173,2090174,2090177,2090178,2090180,2090183,2090185,2090189,2090190,2090191,2090192,2090194,2090198,2090199,2090200,2090206,2090207,2090208,2090209,2090210,2090213,2090214,2090215,2090216,2090218,2090220,2090222,2090224,2090225,2090226,2090228,2090229,2090230,2090231,2090232,2090234,2090236,2090237,2090238,2090239,2090240,2090241,2090242,2090243,2090246,2090249,2090253,2090254,2090255,2090257,2090259,2090260,2090261,2090263,2090264,2090266,2090268,2090269,2090270,2090271,2090272,2090273,2090274,2090278,2090281,2090283,2090284,2090285,2090286,2090288,2090292,2090294,2090298,2090300,2090301,2090302,2090303,2090307,2090309,2090312,2090315,2090316,2090324,2090326,2090327,2090328,2090330,2090334,2090336,2090339,2090343,2090344,2090345,2090346,2090347,2090349,2090350,2090352,2090353,2090354,2090355,2090360,2090363,2090364,2090365,2090370,2090371,2090372,2090373,2090378,2090379,2090381,2090385,2090386,2090387,2090391,2090393,2090395,2090396,2090397,2090402,2090404,2090406,2090410,2090416,2090417,2090418,2090426,2090431,2090433,2090434,2090435,2090437,2090446,2090449,2090453,2090463,2090467,2090475,2090480,2090484,2090488,2090498,2084759,2084787,2085401,2086191,2087473,2087582,2087799,2087813,2087990,2088224,2088426,2088913,2089170,2089591,2089733,2089797,2089920,2089987,2090017,2090053,2090078,2090100,2090126,2090167,2090205,2090247,2090275,2090277,2090293,2090297,2090320,2090333,2090335,2090341,2090351,2090367,2090374,2090380,2090382,2090389,2090392,2090399,2090403,2090411,2090412,2090414,2090423,2090424,2090427,2090429,2090432,2090439,2090440,2090441,2090442,2090443,2090445,2090448,2090454,2090457,2090458,2090459,2090462,2090464,2090469,2090472,2090476,2090477,2090478,2090479,2090481,2090490,2090491,2090493,2090494,2090495,2090496,2090497,2090499,2090500,2090501,2090502,2090503,2090504,2090505,2090506,2090507,2090508,2090510,2090511,2090512,2090514,2090516,2090517,2090518,2090521,2090522,2090525,2090527,2090528,2090529,2090530,2090531,2090532,2090533,2090534,2090536,2090539,2090541,2090543,2090544,2090545,2090547,2090550,2090552,2090553,2090554,2090557,2090559,2090560,2090561,2090562,2090563,2090565,2090568,2090571,2090572,2090573,2090574,2090575,2090579,2090580,2090581,2090583,2090584,2090586,2090587,2090593,2090594,2090595,2090597,2090599,2090600,2090601,2090603,2090604,2090605,2090607,2090608,2090609,2090615,2090616,2090617,2090622,2090623,2090626,2090627,2090628,2090629,2090630,2090631,2090632,2090634,2090635,2090636,2090637,2090638,2090639,2090640,2090641,2090643,2090644,2090648,2090651,2090652,2090653,2090655,2090656,2090657,2090658,2090661,2090662,2090663,2090664,2090665,2090666,2090667,2090668,2090669,2090675,2090677,2090679,2090680,2090681,2090687,2090688,2090689,2090690,2090693,2090694,2090695,2090696,2090697,2090698,2090700,2090701,2090703,2090706,2090707,2090708,2090709,2090710,2090712,2090715,2090717,2090718,2090720,2090721,2090724,2090725,2090726,2090727,2090728,2090729,2090730,2090731,2090734,2090735,2090736,2090737,2090739,2090742,2090743,2090744,2090747,2090750,2090751,2090755,2090756,2090758,2090759,2090760,2090762,2090765,2090769,2090771,2090774,2090776,2090777,2090778,2090779,2090780,2090781,2090784,2090785,2090788,2090790,2090791,2090793,2090794,2090795,2090796,2090797,2090798,2090799,2090801,2090802,2090806,2090808,2090809,2090810,2090811,2090812,2090815,2090816,2090817,2090818,2090819,2090821,2090822,2090823,2090824,2090825,2090828,2090829,2090830,2090831,2090832,2090833,2090834,2090835,2090836,2090837,2090839,2090844,2090847,2090848,2090849,2090851,2090852,2090853,2090854,2090855,2090857,2090858,2090860,2090861,2090868,2090869,2090874,2090875,2090877,2090878,2090879,2090880,2090882,2090883,2090885,2090886,2090889,2090891,2090892,2090894,2090895,2090896,2090897,2090898,2090899,2090901,2090902,2090903,2090904,2090905,2090906,2090909,2090910,2090913,2090914,2090917,2090918,2090919,2090921,2090922,2090923,2090924,2090925,2090926,2090928,2090929,2090932,2090933,2090934,2090935,2090939,2090943,2090944,2090947,2090949,2090950,2090951,2090952,2090953,2090954,2090955,2090956,2090957,2090959,2090960,2090961,2090963,2090965,2090967,2090969,2090971,2090973,2090974,2090975,2090977,2090978,2090984,2090985,2090986,2090988,2090989,2090990,2090995,2090997,2091001,2091002,2091003,2091004,2091005,2091006,2091007,2091008,2091009,2091010,2091011,2091013,2091014,2091015,2091016,2091017,2091018,2091020,2091021,2091022,2091023,2091024,2091028,2091033,2091034,2091035,2091037,2091039,2091040,2091041,2091042,2091043,2091044,2091045,2091047,2091051,2091054,2091057,2091060,2091061,2091062,2091063,2091067,2091068,2091069,2091070,2091071,2091072,2091073,2091074,2091075,2091077,2091079,2091081,2091082,2091084,2091086,2091088,2091091,2091092,2091093,2091094,2091095,2091096,2091097,2091098,2091099,2091100,2091102,2091103,2091104,2091105,2091110,2091111,2091116,2091124,2091139,2091140,2091145,2091146,2091147,2091152,2091154,2091177,2091178,2091186,2091187,2091188,2091189,2091191,2091192,2091196,2091197,2091198,2091199,2091200,2091201,2091203,2091204,2091205,2091206,2091207,2091208,2091209,2091210,2091211,2091216,2091217,2091221,2091224,2091227,2091229,2091230,2091231,2091233,2091234,2091238,2091239,2091241,2091244,2091245,2091247,2091248,2091249,2091255,2091256,2091257,2091259,2091260,2091261,2091264,2091266,2091268,2091270,2091271,2091273,2091282,2091283,2091288,2091290,2091292,2091294,2091296,2091298,2091300,2091302,2091303,2091304,2091305,2091306,2091308,2091309,2091311,2091313,2091317,2091319,2091321,2091322,2091327,2091328,2091331,2091333,2091334,2091336,2091343,2091344,2091347,2091349,2091350,2091352,2091353,2091356,2091366,2091379,2091386,2091387,2091389,2091391,2091392,2091397,2091398,2091403,2091405,2091407,2091414,2091416,2091417,2091419,2091430,2091440
);
update cib_report.tblb1 set loan_ID = contract_no where date_report = '2022-08-31' and  contract_no in (2076261,2077218,2077385,2077789,2078118,2078423,2078430,2081253,2081773,2081815,2084046,2084205,2084994,2085190,2085326,2085633,2085649,2085800,2085812,2085949,2086303,2086314,2086333,2086374,2086405,2086406,2086407,2086422,2086451,2086454,2086459,2086494,2086498,2086499,2086503,2086519,2086526,2086528,2086537,2086561,2086590,2086601,2086604,2086608,2086612,2086614,2086620,2086625,2086626,2086637,2086643,2086649,2086655,2086658,2086664,2086692,2086702,2086707,2086710,2086716,2086717,2086736,2086759,2086767,2086785,2086786,2086789,2086797,2086800,2086804,2086813,2086816,2086823,2086831,2086842,2086845,2086852,2086856,2086875,2086895,2086897,2086905,2086923,2086928,2086930,2086932,2086935,2086944,2086950,2086962,2086966,2086975,2086992,2086993,2086996,2087000,2087003,2087013,2087020,2087025,2087031,2087033,2087034,2087036,2087050,2087057,2087063,2087073,2087074,2087075,2087083,2087109,2087115,2087118,2087119,2087125,2087127,2087128,2087135,2087137,2087139,2087156,2087174,2087183,2087185,2087190,2087194,2087195,2087206,2087207,2087208,2087214,2087218,2087230,2087234,2087235,2087236,2087239,2087244,2087247,2087253,2087267,2087269,2087277,2087282,2087283,2087284,2087286,2087287,2087289,2087292,2087296,2087299,2087300,2087302,2087312,2087313,2087321,2087325,2087326,2087332,2087333,2087335,2087338,2087341,2087345,2087347,2087353,2087355,2087361,2087363,2087364,2087366,2087368,2087370,2087371,2087372,2087373,2087375,2087376,2087377,2087378,2087380,2087382,2087386,2087387,2087389,2087390,2087392,2087393,2087394,2087395,2087398,2087401,2087402,2087403,2087407,2087409,2087410,2087411,2087412,2087414,2087415,2087416,2087417,2087418,2087419,2087420,2087422,2087423,2087425,2087426,2087427,2087428,2087430,2087432,2087433,2087435,2087436,2087437,2087439,2087440,2087442,2087443,2087444,2087451,2087452,2087453,2087454,2087455,2087456,2087458,2087459,2087461,2087463,2087465,2087466,2087467,2087468,2087469,2087470,2087471,2087474,2087475,2087478,2087479,2087480,2087481,2087482,2087483,2087484,2087486,2087488,2087489,2087490,2087492,2087493,2087495,2087496,2087497,2087499,2087500,2087501,2087502,2087503,2087509,2087510,2087511,2087512,2087513,2087514,2087517,2087518,2087519,2087520,2087522,2087523,2087524,2087525,2087526,2087527,2087531,2087534,2087535,2087536,2087537,2087538,2087540,2087541,2087542,2087543,2087544,2087545,2087546,2087547,2087548,2087550,2087551,2087552,2087553,2087554,2087555,2087556,2087557,2087558,2087559,2087560,2087561,2087562,2087563,2087565,2087566,2087567,2087568,2087571,2087572,2087573,2087574,2087576,2087579,2087581,2087584,2087585,2087586,2087587,2087588,2087589,2087590,2087592,2087593,2087594,2087595,2087598,2087600,2087601,2087603,2087606,2087607,2087609,2087610,2087611,2087613,2087614,2087615,2087616,2087617,2087618,2087619,2087621,2087622,2087623,2087624,2087625,2087626,2087627,2087628,2087630,2087631,2087632,2087633,2087634,2087635,2087636,2087637,2087638,2087640,2087641,2087642,2087643,2087644,2087645,2087646,2087647,2087648,2087649,2087650,2087651,2087652,2087653,2087655,2087656,2087657,2087658,2087659,2087660,2087661,2087662,2087664,2087665,2087666,2087667,2087668,2087669,2087670,2087671,2087672,2087673,2087674,2087675,2087676,2087680,2087681,2087683,2087685,2087687,2087688,2087689,2087690,2087692,2087693,2087694,2087695,2087696,2087697,2087699,2087701,2087703,2087704,2087705,2087707,2087708,2087709,2087710,2087711,2087713,2087714,2087715,2087718,2087719,2087721,2087724,2087727,2087728,2087729,2087730,2087731,2087732,2087733,2087735,2087736,2087738,2087739,2087740,2087741,2087742,2087743,2087745,2087747,2087748,2087749,2087750,2087751,2087752,2087753,2087754,2087755,2087756,2087757,2087758,2087759,2087761,2087762,2087763,2087764,2087768,2087771,2087772,2087773,2087774,2087776,2087777,2087778,2087782,2087783,2087785,2087788,2087789,2087790,2087791,2087793,2087794,2087796,2087797,2087798,2087800,2087802,2087803,2087804,2087805,2087806,2087808,2087810,2087812,2087814,2087815,2087816,2087817,2087820,2087823,2087824,2087828,2087829,2087831,2087832,2087833,2087835,2087836,2087837,2087839,2087840,2087841,2087842,2087843,2087845,2087846,2087850,2087851,2087852,2087853,2087856,2087858,2087859,2087863,2087864,2087865,2087867,2087869,2087870,2087872,2087875,2087877,2087878,2087880,2087881,2087882,2087883,2087885,2087886,2087887,2087888,2087889,2087890,2087891,2087892,2087893,2087894,2087895,2087899,2087900,2087901,2087902,2087906,2087907,2087908,2087910,2087911,2087912,2087913,2087914,2087915,2087916,2087917,2087918,2087920,2087921,2087923,2087924,2087925,2087928,2087929,2087930,2087931,2087934,2087935,2087936,2087939,2087941,2087945,2087946,2087949,2087950,2087952,2087953,2087955,2087958,2087959,2087961,2087965,2087967,2087969,2087970,2087971,2087973,2087974,2087975,2087976,2087977,2087979,2087981,2087982,2087983,2087984,2087985,2087986,2087989,2087991,2087992,2087993,2087995,2087996,2087998,2087999,2088000,2088001,2088002,2088004,2088005,2088006,2088007,2088008,2088011,2088012,2088013,2088014,2088015,2088016,2088017,2088018,2088020,2088024,2088025,2088030,2088031,2088032,2088033,2088034,2088037,2088038,2088039,2088040,2088041,2088042,2088044,2088046,2088047,2088048,2088050,2088051,2088054,2088056,2088057,2088058,2088059,2088061,2088062,2088064,2088065,2088066,2088067,2088068,2088069,2088072,2088074,2088075,2088076,2088078,2088081,2088082,2088083,2088084,2088085,2088086,2088087,2088088,2088089,2088090,2088091,2088092,2088093,2088095,2088096,2088097,2088099,2088100,2088102,2088103,2088104,2088105,2088107,2088108,2088109,2088110,2088111,2088112,2088115,2088118,2088119,2088120,2088122,2088123,2088124,2088128,2088129,2088137,2088138,2088140,2088141,2088144,2088145,2088146,2088148,2088150,2088152,2088155,2088156,2088158,2088160,2088162,2088163,2088164,2088165,2088166,2088171,2088174,2088175,2088176,2088177,2088178,2088179,2088180,2088181,2088183,2088184,2088185,2088188,2088189,2088190,2088191,2088192,2088193,2088194,2088196,2088197,2088198,2088199,2088200,2088201,2088203,2088206,2088207,2088208,2088211,2088212,2088213,2088215,2088216,2088219,2088221,2088222,2088223,2088225,2088226,2088227,2088228,2088229,2088230,2088231,2088232,2088234,2088235,2088238,2088239,2088240,2088241,2088243,2088245,2088246,2088247,2088249,2088250,2088251,2088252,2088255,2088256,2088259,2088260,2088261,2088262,2088264,2088266,2088270,2088273,2088274,2088275,2088278,2088281,2088283,2088285,2088286,2088290,2088291,2088292,2088293,2088294,2088297,2088302,2088304,2088305,2088306,2088307,2088309,2088314,2088316,2088318,2088319,2088322,2088326,2088327,2088328,2088330,2088332,2088334,2088335,2088337,2088339,2088341,2088344,2088345,2088346,2088347,2088349,2088350,2088351,2088352,2088353,2088354,2088355,2088356,2088359,2088361,2088362,2088366,2088368,2088371,2088372,2088373,2088374,2088375,2088376,2088377,2088378,2088381,2088384,2088385,2088386,2088387,2088389,2088391,2088392,2088395,2088396,2088397,2088400,2088402,2088405,2088407,2088408,2088410,2088412,2088417,2088418,2088419,2088424,2088428,2088429,2088431,2088432,2088434,2088436,2088438,2088439,2088444,2088446,2088447,2088449,2088450,2088451,2088452,2088453,2088457,2088458,2088459,2088460,2088461,2088462,2088463,2088464,2088467,2088468,2088471,2088473,2088474,2088476,2088477,2088478,2088481,2088482,2088484,2088488,2088489,2088492,2088494,2088496,2088505,2088506,2088508,2088509,2088527,2088530,2088534,2076779,2077686,2082449,2084613,2085053,2085298,2085775,2085869,2086119,2086967,2087211,2087408,2087464,2087583,2087786,2087787,2087897,2087944,2087997,2088021,2088070,2088153,2088161,2088220,2088237,2088254,2088271,2088272,2088277,2088288,2088296,2088313,2088340,2088365,2088367,2088370,2088383,2088388,2088403,2088406,2088411,2088414,2088420,2088421,2088425,2088430,2088433,2088435,2088441,2088443,2088445,2088448,2088454,2088466,2088469,2088470,2088475,2088479,2088483,2088490,2088493,2088495,2088497,2088498,2088499,2088500,2088501,2088503,2088504,2088511,2088514,2088515,2088516,2088519,2088520,2088521,2088523,2088524,2088525,2088528,2088529,2088531,2088536,2088537,2088544,2088545,2088546,2088547,2088548,2088549,2088550,2088551,2088552,2088553,2088555,2088556,2088557,2088559,2088560,2088561,2088562,2088564,2088565,2088566,2088567,2088568,2088569,2088572,2088573,2088574,2088575,2088576,2088577,2088579,2088580,2088581,2088582,2088583,2088584,2088585,2088586,2088588,2088589,2088591,2088592,2088593,2088594,2088597,2088598,2088599,2088600,2088602,2088603,2088604,2088610,2088613,2088614,2088617,2088618,2088619,2088620,2088621,2088622,2088623,2088624,2088625,2088626,2088627,2088628,2088629,2088631,2088632,2088633,2088634,2088635,2088636,2088637,2088639,2088641,2088643,2088644,2088645,2088647,2088650,2088651,2088652,2088653,2088656,2088658,2088661,2088662,2088663,2088664,2088665,2088666,2088667,2088668,2088671,2088672,2088673,2088677,2088678,2088679,2088680,2088681,2088682,2088683,2088686,2088688,2088689,2088692,2088693,2088694,2088695,2088697,2088698,2088699,2088700,2088702,2088703,2088707,2088708,2088712,2088713,2088715,2088716,2088717,2088718,2088723,2088724,2088725,2088729,2088730,2088731,2088733,2088734,2088735,2088736,2088738,2088740,2088742,2088743,2088744,2088745,2088747,2088748,2088749,2088750,2088754,2088755,2088757,2088758,2088759,2088760,2088761,2088763,2088764,2088765,2088773,2088774,2088775,2088777,2088778,2088782,2088783,2088784,2088787,2088788,2088789,2088791,2088794,2088795,2088800,2088802,2088804,2088806,2088808,2088812,2088814,2088815,2088816,2088818,2088819,2088820,2088821,2088825,2088826,2088828,2088830,2088831,2088832,2088833,2088834,2088835,2088837,2088838,2088840,2088841,2088842,2088843,2088844,2088845,2088846,2088849,2088850,2088851,2088852,2088854,2088856,2088857,2088858,2088859,2088861,2088862,2088865,2088866,2088867,2088868,2088869,2088871,2088873,2088874,2088875,2088876,2088877,2088878,2088879,2088880,2088881,2088882,2088883,2088885,2088886,2088887,2088888,2088889,2088891,2088894,2088895,2088897,2088898,2088899,2088900,2088901,2088902,2088903,2088904,2088905,2088906,2088907,2088909,2088910,2088912,2088914,2088916,2088917,2088919,2088920,2088921,2088922,2088924,2088925,2088926,2088927,2088929,2088930,2088931,2088932,2088935,2088936,2088937,2088939,2088940,2088941,2088942,2088943,2088946,2088947,2088948,2088949,2088950,2088952,2088954,2088956,2088958,2088959,2088960,2088961,2088962,2088963,2088964,2088965,2088967,2088968,2088969,2088970,2088972,2088973,2088974,2088975,2088977,2088978,2088980,2088981,2088982,2088983,2088984,2088985,2088987,2088989,2088990,2088991,2088993,2088995,2088997,2088999,2089002,2089003,2089004,2089006,2089008,2089009,2089011,2089013,2089014,2089015,2089017,2089019,2089021,2089024,2089026,2089030,2089032,2089033,2089034,2089038,2089039,2089040,2089041,2089047,2089048,2089049,2089050,2089051,2089052,2089053,2089055,2089056,2089058,2089059,2089062,2089063,2089066,2089067,2089068,2089069,2089072,2089073,2089074,2089075,2089077,2089080,2089083,2089084,2089085,2089088,2089089,2089094,2089096,2089097,2089099,2089100,2089102,2089103,2089104,2089106,2089107,2089110,2089111,2089112,2089113,2089115,2089117,2089118,2089119,2089120,2089121,2089123,2089124,2089126,2089127,2089128,2089129,2089131,2089134,2089138,2089139,2089140,2089141,2089142,2089143,2089144,2089146,2089147,2089148,2089150,2089151,2089152,2089153,2089154,2089156,2089160,2089161,2089163,2089164,2089165,2089166,2089167,2089168,2089169,2089171,2089172,2089173,2089175,2089176,2089177,2089180,2089181,2089182,2089183,2089184,2089185,2089186,2089187,2089188,2089190,2089192,2089193,2089194,2089197,2089198,2089201,2089204,2089205,2089206,2089209,2089210,2089213,2089214,2089216,2089217,2089218,2089219,2089220,2089222,2089223,2089225,2089226,2089228,2089230,2089231,2089233,2089234,2089237,2089238,2089239,2089241,2089242,2089243,2089246,2089247,2089248,2089249,2089252,2089255,2089259,2089261,2089264,2089265,2089266,2089269,2089270,2089272,2089273,2089274,2089276,2089277,2089279,2089281,2089282,2089283,2089286,2089288,2089291,2089292,2089293,2089295,2089296,2089299,2089302,2089304,2089306,2089307,2089308,2089309,2089310,2089311,2089312,2089314,2089315,2089316,2089317,2089319,2089321,2089324,2089325,2089326,2089329,2089332,2089333,2089335,2089337,2089338,2089340,2089341,2089343,2089346,2089347,2089349,2089352,2089353,2089355,2089356,2089357,2089359,2089360,2089361,2089362,2089363,2089366,2089368,2089369,2089370,2089373,2089374,2089375,2089377,2089378,2089379,2089381,2089384,2089385,2089388,2089393,2089394,2089398,2089399,2089401,2089404,2089407,2089408,2089410,2089411,2089412,2089414,2089416,2089422,2089428,2089430,2089432,2089433,2089434,2089435,2089437,2089438,2089441,2089443,2089452,2089453,2089456,2089458,2089460,2089463,2089464,2089467,2089468,2089470,2089480,2089483,2089484,2089486,2089489,2089501,2089504,2089514,2089516,2089519,2042063,2067865,2076481,2078956,2081057,2081640,2082932,2083881,2084062,2084265,2085196,2086052,2086213,2087123,2087485,2087580,2087838,2088063,2088136,2088308,2088338,2088539,2088542,2088752,2088769,2088809,2088811,2088892,2088971,2088988,2089025,2089028,2089037,2089065,2089191,2089278,2089328,2089348,2089364,2089365,2089376,2089383,2089386,2089387,2089396,2089397,2089402,2089403,2089405,2089415,2089417,2089420,2089421,2089424,2089436,2089439,2089444,2089446,2089447,2089449,2089451,2089457,2089459,2089462,2089472,2089475,2089477,2089485,2089488,2089495,2089496,2089497,2089499,2089502,2089503,2089506,2089507,2089508,2089509,2089510,2089512,2089515,2089517,2089520,2089524,2089525,2089526,2089527,2089528,2089529,2089530,2089531,2089532,2089533,2089536,2089537,2089539,2089540,2089541,2089542,2089543,2089545,2089546,2089548,2089549,2089550,2089551,2089554,2089555,2089556,2089557,2089559,2089560,2089562,2089564,2089565,2089566,2089570,2089571,2089572,2089573,2089575,2089576,2089577,2089578,2089579,2089580,2089581,2089582,2089584,2089585,2089586,2089587,2089589,2089593,2089595,2089596,2089598,2089599,2089600,2089603,2089605,2089606,2089607,2089608,2089609,2089610,2089611,2089612,2089613,2089614,2089615,2089616,2089617,2089618,2089619,2089623,2089624,2089625,2089627,2089629,2089631,2089633,2089634,2089635,2089636,2089637,2089638,2089639,2089640,2089641,2089643,2089645,2089646,2089647,2089648,2089649,2089650,2089651,2089652,2089655,2089656,2089657,2089658,2089660,2089661,2089662,2089663,2089664,2089665,2089667,2089668,2089669,2089670,2089672,2089674,2089675,2089676,2089677,2089682,2089687,2089688,2089689,2089691,2089692,2089693,2089694,2089695,2089696,2089699,2089700,2089702,2089704,2089705,2089706,2089707,2089711,2089714,2089715,2089719,2089721,2089724,2089726,2089727,2089729,2089730,2089731,2089734,2089737,2089738,2089739,2089740,2089741,2089742,2089743,2089745,2089746,2089747,2089748,2089749,2089750,2089751,2089752,2089753,2089754,2089756,2089757,2089758,2089759,2089761,2089762,2089763,2089764,2089765,2089766,2089769,2089770,2089771,2089772,2089773,2089775,2089776,2089777,2089778,2089779,2089780,2089781,2089782,2089783,2089785,2089786,2089788,2089789,2089791,2089793,2089794,2089795,2089796,2089798,2089800,2089803,2089804,2089805,2089807,2089809,2089810,2089811,2089812,2089813,2089814,2089818,2089820,2089821,2089822,2089823,2089824,2089826,2089827,2089829,2089830,2089831,2089832,2089833,2089835,2089836,2089838,2089842,2089844,2089845,2089848,2089849,2089850,2089851,2089852,2089853,2089854,2089857,2089861,2089863,2089866,2089867,2089868,2089871,2089872,2089873,2089875,2089876,2089877,2089879,2089882,2089883,2089884,2089885,2089886,2089887,2089888,2089889,2089891,2089892,2089894,2089895,2089896,2089897,2089899,2089902,2089904,2089905,2089907,2089910,2089912,2089913,2089914,2089915,2089916,2089917,2089918,2089919,2089922,2089924,2089925,2089926,2089928,2089929,2089930,2089932,2089933,2089936,2089938,2089939,2089941,2089943,2089944,2089945,2089947,2089950,2089951,2089952,2089953,2089954,2089955,2089958,2089961,2089963,2089966,2089970,2089971,2089975,2089976,2089978,2089980,2089981,2089983,2089985,2089988,2089990,2089991,2089993,2089995,2089996,2089997,2089998,2089999,2090000,2090002,2090003,2090004,2090006,2090007,2090008,2090009,2090010,2090012,2090013,2090014,2090016,2090019,2090021,2090022,2090024,2090026,2090027,2090029,2090032,2090037,2090040,2090043,2090045,2090048,2090049,2090050,2090057,2090058,2090059,2090060,2090063,2090064,2090065,2090067,2090069,2090070,2090071,2090074,2090076,2090077,2090079,2090080,2090081,2090083,2090084,2090085,2090087,2090088,2090089,2090090,2090091,2090092,2090093,2090095,2090098,2090099,2090101,2090102,2090105,2090106,2090108,2090109,2090112,2090113,2090114,2090115,2090116,2090117,2090119,2090120,2090121,2090122,2090123,2090124,2090125,2090127,2090129,2090130,2090131,2090134,2090135,2090137,2090139,2090140,2090141,2090143,2090144,2090145,2090147,2090148,2090149,2090151,2090152,2090153,2090155,2090156,2090157,2090158,2090160,2090163,2090166,2090168,2090169,2090170,2090172,2090173,2090174,2090177,2090178,2090180,2090183,2090185,2090189,2090190,2090191,2090192,2090194,2090198,2090199,2090200,2090206,2090207,2090208,2090209,2090210,2090213,2090214,2090215,2090216,2090218,2090220,2090222,2090224,2090225,2090226,2090228,2090229,2090230,2090231,2090232,2090234,2090236,2090237,2090238,2090239,2090240,2090241,2090242,2090243,2090246,2090249,2090253,2090254,2090255,2090257,2090259,2090260,2090261,2090263,2090264,2090266,2090268,2090269,2090270,2090271,2090272,2090273,2090274,2090278,2090281,2090283,2090284,2090285,2090286,2090288,2090292,2090294,2090298,2090300,2090301,2090302,2090303,2090307,2090309,2090312,2090315,2090316,2090324,2090326,2090327,2090328,2090330,2090334,2090336,2090339,2090343,2090344,2090345,2090346,2090347,2090349,2090350,2090352,2090353,2090354,2090355,2090360,2090363,2090364,2090365,2090370,2090371,2090372,2090373,2090378,2090379,2090381,2090385,2090386,2090387,2090391,2090393,2090395,2090396,2090397,2090402,2090404,2090406,2090410,2090416,2090417,2090418,2090426,2090431,2090433,2090434,2090435,2090437,2090446,2090449,2090453,2090463,2090467,2090475,2090480,2090484,2090488,2090498,2084759,2084787,2085401,2086191,2087473,2087582,2087799,2087813,2087990,2088224,2088426,2088913,2089170,2089591,2089733,2089797,2089920,2089987,2090017,2090053,2090078,2090100,2090126,2090167,2090205,2090247,2090275,2090277,2090293,2090297,2090320,2090333,2090335,2090341,2090351,2090367,2090374,2090380,2090382,2090389,2090392,2090399,2090403,2090411,2090412,2090414,2090423,2090424,2090427,2090429,2090432,2090439,2090440,2090441,2090442,2090443,2090445,2090448,2090454,2090457,2090458,2090459,2090462,2090464,2090469,2090472,2090476,2090477,2090478,2090479,2090481,2090490,2090491,2090493,2090494,2090495,2090496,2090497,2090499,2090500,2090501,2090502,2090503,2090504,2090505,2090506,2090507,2090508,2090510,2090511,2090512,2090514,2090516,2090517,2090518,2090521,2090522,2090525,2090527,2090528,2090529,2090530,2090531,2090532,2090533,2090534,2090536,2090539,2090541,2090543,2090544,2090545,2090547,2090550,2090552,2090553,2090554,2090557,2090559,2090560,2090561,2090562,2090563,2090565,2090568,2090571,2090572,2090573,2090574,2090575,2090579,2090580,2090581,2090583,2090584,2090586,2090587,2090593,2090594,2090595,2090597,2090599,2090600,2090601,2090603,2090604,2090605,2090607,2090608,2090609,2090615,2090616,2090617,2090622,2090623,2090626,2090627,2090628,2090629,2090630,2090631,2090632,2090634,2090635,2090636,2090637,2090638,2090639,2090640,2090641,2090643,2090644,2090648,2090651,2090652,2090653,2090655,2090656,2090657,2090658,2090661,2090662,2090663,2090664,2090665,2090666,2090667,2090668,2090669,2090675,2090677,2090679,2090680,2090681,2090687,2090688,2090689,2090690,2090693,2090694,2090695,2090696,2090697,2090698,2090700,2090701,2090703,2090706,2090707,2090708,2090709,2090710,2090712,2090715,2090717,2090718,2090720,2090721,2090724,2090725,2090726,2090727,2090728,2090729,2090730,2090731,2090734,2090735,2090736,2090737,2090739,2090742,2090743,2090744,2090747,2090750,2090751,2090755,2090756,2090758,2090759,2090760,2090762,2090765,2090769,2090771,2090774,2090776,2090777,2090778,2090779,2090780,2090781,2090784,2090785,2090788,2090790,2090791,2090793,2090794,2090795,2090796,2090797,2090798,2090799,2090801,2090802,2090806,2090808,2090809,2090810,2090811,2090812,2090815,2090816,2090817,2090818,2090819,2090821,2090822,2090823,2090824,2090825,2090828,2090829,2090830,2090831,2090832,2090833,2090834,2090835,2090836,2090837,2090839,2090844,2090847,2090848,2090849,2090851,2090852,2090853,2090854,2090855,2090857,2090858,2090860,2090861,2090868,2090869,2090874,2090875,2090877,2090878,2090879,2090880,2090882,2090883,2090885,2090886,2090889,2090891,2090892,2090894,2090895,2090896,2090897,2090898,2090899,2090901,2090902,2090903,2090904,2090905,2090906,2090909,2090910,2090913,2090914,2090917,2090918,2090919,2090921,2090922,2090923,2090924,2090925,2090926,2090928,2090929,2090932,2090933,2090934,2090935,2090939,2090943,2090944,2090947,2090949,2090950,2090951,2090952,2090953,2090954,2090955,2090956,2090957,2090959,2090960,2090961,2090963,2090965,2090967,2090969,2090971,2090973,2090974,2090975,2090977,2090978,2090984,2090985,2090986,2090988,2090989,2090990,2090995,2090997,2091001,2091002,2091003,2091004,2091005,2091006,2091007,2091008,2091009,2091010,2091011,2091013,2091014,2091015,2091016,2091017,2091018,2091020,2091021,2091022,2091023,2091024,2091028,2091033,2091034,2091035,2091037,2091039,2091040,2091041,2091042,2091043,2091044,2091045,2091047,2091051,2091054,2091057,2091060,2091061,2091062,2091063,2091067,2091068,2091069,2091070,2091071,2091072,2091073,2091074,2091075,2091077,2091079,2091081,2091082,2091084,2091086,2091088,2091091,2091092,2091093,2091094,2091095,2091096,2091097,2091098,2091099,2091100,2091102,2091103,2091104,2091105,2091110,2091111,2091116,2091124,2091139,2091140,2091145,2091146,2091147,2091152,2091154,2091177,2091178,2091186,2091187,2091188,2091189,2091191,2091192,2091196,2091197,2091198,2091199,2091200,2091201,2091203,2091204,2091205,2091206,2091207,2091208,2091209,2091210,2091211,2091216,2091217,2091221,2091224,2091227,2091229,2091230,2091231,2091233,2091234,2091238,2091239,2091241,2091244,2091245,2091247,2091248,2091249,2091255,2091256,2091257,2091259,2091260,2091261,2091264,2091266,2091268,2091270,2091271,2091273,2091282,2091283,2091288,2091290,2091292,2091294,2091296,2091298,2091300,2091302,2091303,2091304,2091305,2091306,2091308,2091309,2091311,2091313,2091317,2091319,2091321,2091322,2091327,2091328,2091331,2091333,2091334,2091336,2091343,2091344,2091347,2091349,2091350,2091352,2091353,2091356,2091366,2091379,2091386,2091387,2091389,2091391,2091392,2091397,2091398,2091403,2091405,2091407,2091414,2091416,2091417,2091419,2091430,2091440
);


-- update 2023-08-25

select contract_no , number_of_days_slow , loan_class , 
	CASE when contract_no in (2051043) then 'A'
		WHEN number_of_days_slow BETWEEN 0 AND 30 THEN 'A'
		WHEN number_of_days_slow BETWEEN 31 AND 60 THEN 'B'
		WHEN number_of_days_slow BETWEEN 61 AND 90 THEN 'C'
		WHEN number_of_days_slow BETWEEN 91 AND 180 THEN 'D'
		ELSE 'E' -- > 180 days
	end 'loan_class2'
from cib_report.tblb1 where date_report = '2025-02-28';


update cib_report.tblb1 
set loan_class = CASE when contract_no in (2051043) then 'A'
		WHEN number_of_days_slow BETWEEN 0 AND 30 THEN 'A'
		WHEN number_of_days_slow BETWEEN 31 AND 60 THEN 'B'
		WHEN number_of_days_slow BETWEEN 61 AND 90 THEN 'C'
		WHEN number_of_days_slow BETWEEN 91 AND 180 THEN 'D'
		ELSE 'E' -- > 180 days
	end
where date_report = '2025-02-28';